import React, { useState, useEffect, useRef } from 'react';

const PAYMENT_URL = "https://buymeacoffee.com/surwin";

const LANGUAGES = [
  { code: 'az', name: 'AzÉ™rbaycan', flag: 'ğŸ‡¦ğŸ‡¿', currency: 'AZN', rate: 1 },
  { code: 'en', name: 'English', flag: 'ğŸ‡¬ğŸ‡§', currency: 'USD', rate: 0.59 },
  { code: 'ru', name: 'Ğ ÑƒÑÑĞºĞ¸Ğ¹', flag: 'ğŸ‡·ğŸ‡º', currency: 'RUB', rate: 54.4 },
];

const TRANSLATIONS: Record<string, any> = {
  az: {
    balance: "Balans",
    topUpHeading: "BALANSIN ARTIR",
    topUpText: "TÉ™hlÃ¼kÉ™siz Ã¶dÉ™niÅŸ Ã¼Ã§Ã¼n dÃ¼ymÉ™yÉ™ keÃ§id edin.",
    payStripe: "BalansÄ± ArtÄ±r (â˜•)",
    demoBalance: "Demo Balans",
  },
  en: {
    balance: "Balance",
    topUpHeading: "RECHARGE BALANCE",
    topUpText: "Click the button below for secure payment.",
    payStripe: "Top Up Now (â˜•)",
    demoBalance: "Demo Balance",
  },
  ru: {
    balance: "Ğ‘Ğ°Ğ»Ğ°Ğ½Ñ",
    topUpHeading: "ĞŸĞĞŸĞĞ›ĞĞ˜Ğ¢Ğ¬ Ğ‘ĞĞ›ĞĞĞ¡",
    topUpText: "ĞĞ°Ğ¶Ğ¼Ğ¸Ñ‚Ğµ ĞºĞ½Ğ¾Ğ¿ĞºÑƒ Ğ½Ğ¸Ğ¶Ğµ Ğ´Ğ»Ñ Ğ±ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾Ğ¹ Ğ¾Ğ¿Ğ»Ğ°Ñ‚Ñ‹.",
    payStripe: "ĞŸĞ¾Ğ¿Ğ¾Ğ»Ğ½Ğ¸Ñ‚ÑŒ (â˜•)",
    demoBalance: "Ğ”ĞµĞ¼Ğ¾ Ğ‘Ğ°Ğ»Ğ°Ğ½Ñ",
  },
};

const App: React.FC = () => {
  const [balance, setBalance] = useState<number>(0); // baÅŸlanÄŸÄ±c 0
  const [lang, setLang] = useState<string>('az');
  const [showTopUp, setShowTopUp] = useState(true);

  const t = TRANSLATIONS[lang];

  const formatBalance = (val: number) => {
    const curr = LANGUAGES.find(l => l.code === lang)?.currency || 'AZN';
    return `${val.toFixed(2)} ${curr}`;
  };

  const handleDemoBalance = () => {
    setBalance(10); // Demo balans artÄ±rma
    setShowTopUp(false);
  };

  return (
    <div className="min-h-screen bg-[#0f172a] flex flex-col items-center justify-center text-white p-4">
      <div className="flex gap-2 mb-4">
        {LANGUAGES.map(l => (
          <button key={l.code} onClick={() => setLang(l.code)} className="text-2xl">{l.flag}</button>
        ))}
      </div>

      <div className="bg-slate-900 p-4 rounded-xl w-full max-w-sm text-center shadow-lg">
        <h1 className="text-xl font-bold mb-2">{t.balance}</h1>
        <p className="text-2xl font-extrabold">{formatBalance(balance)}</p>
      </div>

      {showTopUp && (
        <div className="mt-6 bg-slate-800 p-6 rounded-2xl w-full max-w-sm shadow-xl text-center">
          <h2 className="text-lg font-black mb-2">{t.topUpHeading}</h2>
          <p className="text-sm text-gray-300 mb-4">{t.topUpText}</p>
          <button
            onClick={() => window.open(PAYMENT_URL, "_blank")}
            className="bg-yellow-400 text-black font-bold px-6 py-3 rounded-lg mb-2 hover:scale-105 transition-transform"
          >
            {t.payStripe}
          </button>
          <button
            onClick={handleDemoBalance}
            className="text-sm text-gray-400 underline hover:text-white"
          >
            {t.demoBalance}
          </button>
        </div>
      )}

      {!showTopUp && (
        <div className="mt-6 text-center">
          <p className="text-green-400 font-bold text-lg">Oyun artÄ±q baÅŸlayÄ±r! ğŸ®</p>
        </div>
      )}
    </div>
  );
};

export default App;
