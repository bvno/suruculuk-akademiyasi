<!DOCTYPE html>
<html lang="az" id="htmlTag">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Premium Drive - Tam GÉ™lir Sistemi</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { user-select: none; -webkit-user-select: none; touch-action: none; overflow: hidden; background-color: #020617; } 
        .hidden { display: none !important; }
        
        html[dir="rtl"] { font-family: 'Tahoma', 'Arial', sans-serif; }
        html[dir="rtl"] .text-left { text-align: right; }
        html[dir="rtl"] .flex-row { flex-direction: row-reverse; }
        
        .glass-panel {
            background: rgba(15, 23, 42, 0.6);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.08);
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.37);
        }
        .neon-cyan { text-shadow: 0 0 10px rgba(34, 211, 238, 0.8); }
        .neon-emerald { text-shadow: 0 0 10px rgba(16, 185, 129, 0.8); }
        .neon-rose { text-shadow: 0 0 10px rgba(244, 63, 94, 0.8); }
        .neon-box-cyan { box-shadow: 0 0 20px rgba(34, 211, 238, 0.15); }
        .brake-shadow { box-shadow: 0 0 40px rgba(225, 29, 72, 0.6); }
        
        .custom-scrollbar::-webkit-scrollbar { width: 6px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: rgba(255,255,255,0.05); border-radius: 10px; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: rgba(34,211,238,0.3); border-radius: 10px; }

        @keyframes shake {
            0% { transform: translate(1px, 1px) rotate(0deg); }
            10% { transform: translate(-1px, -2px) rotate(-1deg); }
            20% { transform: translate(-3px, 0px) rotate(1deg); }
            30% { transform: translate(3px, 2px) rotate(0deg); }
            40% { transform: translate(1px, -1px) rotate(1deg); }
            50% { transform: translate(-1px, 2px) rotate(-1deg); }
            60% { transform: translate(-3px, 1px) rotate(0deg); }
            70% { transform: translate(3px, 1px) rotate(-1deg); }
            80% { transform: translate(-1px, -1px) rotate(1deg); }
            90% { transform: translate(1px, 2px) rotate(0deg); }
            100% { transform: translate(1px, -2px) rotate(-1deg); }
        }
        .shake-effect { animation: shake 0.3s; }
    </style>
</head>
<body class="text-white h-screen flex flex-col font-sans relative transition-all duration-300">

    <div id="globalLangSelector" class="absolute top-4 right-4 z-[200] hidden">
        <button id="langToggleBtn" class="glass-panel px-4 py-2 rounded-2xl flex items-center gap-2 font-bold shadow-lg active:scale-95 transition-all text-sm">
            <span id="currentFlagIcon">ğŸ‡¦ğŸ‡¿</span> <span id="currentCurrCode">AZN</span>
        </button>
    </div>

    <div id="langSelectModal" class="hidden h-screen flex flex-col items-center justify-center p-6 z-[300] absolute inset-0 bg-[#020617]/95 backdrop-blur-xl">
        <div class="glass-panel p-8 rounded-[32px] w-full max-w-sm text-center relative">
            <h2 class="text-2xl font-black mb-6 neon-cyan uppercase">Select Language</h2>
            <div id="langListContainer" class="grid grid-cols-2 gap-3 max-h-[60vh] overflow-y-auto custom-scrollbar pr-2">
                </div>
        </div>
    </div>

    <div id="authScreen" class="hidden h-screen flex items-center justify-center p-6 z-[60] absolute inset-0 bg-[#020617]">
        <div class="glass-panel p-8 rounded-[32px] w-full max-w-md text-center relative overflow-y-auto max-h-[95vh] custom-scrollbar">
            <h1 class="text-3xl font-black text-white italic mb-4 tracking-tighter neon-cyan" data-i18n="regTitle">QEYDÄ°YYAT</h1>
            
            <div class="bg-rose-500/10 border border-rose-500/30 p-4 rounded-xl text-left mb-6 text-xs text-rose-300 space-y-2">
                <p class="font-bold text-rose-400 mb-1" data-i18n="rulesTitle">QAYDALAR:</p>
                <p data-i18n="rule1">â€¢ HÉ™r bir istifadÉ™Ã§i yalnÄ±z 1 dÉ™fÉ™ qeydiyyatdan keÃ§É™ bilÉ™r.</p>
                <p data-i18n="rule2">â€¢ Eyni cihazdan birdÉ™n Ã§ox hesab yaradÄ±larsa, sistem avtomatik ban edÉ™cÉ™k.</p>
                <p data-i18n="rule3">â€¢ SÄ±fÄ±r balansla oyuna baÅŸlamaq qadaÄŸandÄ±r.</p>
            </div>

            <form id="registerForm" class="space-y-4">
                <input type="text" id="regFullName" data-i18n-ph="phName" placeholder="Ad vÉ™ Soyad" required class="w-full p-4 rounded-2xl bg-[#020617] border border-slate-700 text-white outline-none focus:border-cyan-500 text-sm">
                <input type="text" id="regUsername" data-i18n-ph="phUser" placeholder="Ä°stifadÉ™Ã§i AdÄ±" required class="w-full p-4 rounded-2xl bg-[#020617] border border-slate-700 text-white outline-none focus:border-cyan-500 text-sm">
                <input type="number" id="regAge" data-i18n-ph="phAge" placeholder="YaÅŸ" required min="1" class="w-full p-4 rounded-2xl bg-[#020617] border border-slate-700 text-white outline-none focus:border-cyan-500 text-sm">
                <input type="password" id="regPassword" data-i18n-ph="phPass" placeholder="ÅifrÉ™ (Min. 6 simvol)" required minlength="6" class="w-full p-4 rounded-2xl bg-[#020617] border border-slate-700 text-white outline-none focus:border-cyan-500 text-sm">
                <button type="submit" class="w-full py-4 bg-cyan-500/20 border border-cyan-500/50 text-cyan-300 rounded-[24px] font-bold uppercase tracking-widest shadow-[0_0_15px_rgba(34,211,238,0.2)] active:scale-95 transition-all" data-i18n="btnReg">QEYDÄ°YYATDAN KEÃ‡</button>
            </form>
            <p class="mt-4 text-xs text-slate-400"><span data-i18n="hasAcc">HesabÄ±nÄ±z var?</span> <button id="showLoginBtn" type="button" class="text-cyan-400 font-bold underline" data-i18n="btnLoginNav">Daxil olun</button></p>
        </div>
    </div>

    <div id="loginFormScreen" class="hidden h-screen flex items-center justify-center p-6 z-[60] absolute inset-0 bg-[#020617]">
        <div class="glass-panel p-8 rounded-[32px] w-full max-w-md text-center relative">
            <h1 class="text-3xl font-black text-white italic mb-6 tracking-tighter neon-cyan" data-i18n="logTitle">GÄ°RÄ°Å</h1>
            <form id="loginUserForm" class="space-y-4">
                <input type="text" id="logUsername" data-i18n-ph="phUser" placeholder="Ä°stifadÉ™Ã§i AdÄ±" required class="w-full p-4 rounded-2xl bg-[#020617] border border-slate-700 text-white outline-none focus:border-cyan-500 text-sm">
                <input type="password" id="logPassword" data-i18n-ph="phPass2" placeholder="ÅifrÉ™" required class="w-full p-4 rounded-2xl bg-[#020617] border border-slate-700 text-white outline-none focus:border-cyan-500 text-sm">
                <p id="loginError" class="text-rose-500 text-xs hidden font-bold" data-i18n="errLogin">MÉ™lumatlar yanlÄ±ÅŸdÄ±r!</p>
                <button type="submit" class="w-full py-4 bg-cyan-500/20 border border-cyan-500/50 text-cyan-300 rounded-[24px] font-bold uppercase tracking-widest shadow-[0_0_15px_rgba(34,211,238,0.2)] active:scale-95 transition-all" data-i18n="btnLog">DAXÄ°L OL</button>
            </form>
            <p class="mt-4 text-xs text-slate-400"><span data-i18n="noAcc">HesabÄ±nÄ±z yoxdur?</span> <button id="showRegisterBtn" type="button" class="text-cyan-400 font-bold underline" data-i18n="btnRegNav">Qeydiyyat</button></p>
        </div>
    </div>

    <div id="banScreen" class="hidden h-screen flex items-center justify-center p-6 z-[100] absolute inset-0 bg-[#020617]">
        <div class="glass-panel p-8 rounded-[32px] w-full max-w-sm text-center border border-rose-500/50">
            <div class="w-20 h-20 rounded-full bg-rose-500/20 flex items-center justify-center mb-4 mx-auto"><span class="text-4xl">ğŸš«</span></div>
            <h2 class="text-2xl font-black text-rose-500 mb-2 neon-rose" data-i18n="banTitle">HESAB BLOKLANDI</h2>
            <p class="text-slate-300 text-sm" data-i18n="banText">SistemdÉ™ Ã§oxlu hesab yaratmaÄŸa cÉ™hd etdiyiniz Ã¼Ã§Ã¼n cihazÄ±nÄ±z bloklanmÄ±ÅŸdÄ±r.</p>
        </div>
    </div>

    <div id="loginScreen" class="hidden h-screen flex items-center justify-center p-6 z-50 absolute inset-0 bg-[#020617]">
        <div class="glass-panel p-10 rounded-[32px] w-full max-w-sm text-center relative overflow-hidden">
            <div class="absolute -top-10 -left-10 w-32 h-32 bg-cyan-500/20 rounded-full blur-[40px]"></div>
            
            <h1 class="text-3xl font-black text-white italic mb-2 tracking-tighter neon-cyan relative z-10">PREMIUM DRIVE</h1>
            <p class="text-slate-400 text-sm mb-8 relative z-10"><span id="lbl_loginBalance" data-i18n="lblBal">Balans:</span> <span id="loginBalanceText" class="font-bold text-cyan-400 neon-cyan">0.00 AZN</span></p>
            
            <button id="loginBtn" class="w-full py-4 bg-cyan-500/20 border border-cyan-500/50 text-cyan-300 rounded-[24px] font-bold uppercase tracking-widest shadow-[0_0_15px_rgba(34,211,238,0.2)] active:scale-95 transition-all relative z-10" data-i18n="btnStart">
                Oyuna BaÅŸla
            </button>
            <button id="loginTopupBtn" class="w-full mt-4 py-4 glass-panel rounded-[24px] text-white font-bold uppercase tracking-widest active:scale-95 transition-all relative z-10" data-i18n="btnTopup">
                BalansÄ± ArtÄ±r
            </button>
        </div>
    </div>

    <div id="gameScreen" class="hidden h-screen flex flex-col relative overflow-hidden bg-[#020617]">
        <div class="p-4 flex justify-between items-center z-30 shrink-0">
            <div class="flex gap-2">
                <div class="glass-panel p-2 px-4 rounded-[20px] transition-all" id="balanceBox">
                    <p id="lbl_hudBalance" class="text-[9px] font-black text-cyan-400 uppercase tracking-[2px] mb-0.5 opacity-80" data-i18n="hudBal">Balans</p>
                    <p id="balanceText" class="text-base font-black neon-cyan">0.00 AZN</p>
                </div>
                <div class="glass-panel p-2 px-4 rounded-[20px]">
                    <p id="lbl_hudDistance" class="text-[9px] font-black text-emerald-400 uppercase tracking-[2px] mb-0.5 opacity-80" data-i18n="hudDist">MÉ™safÉ™</p>
                    <p id="scoreText" class="text-base font-black neon-emerald">0 M</p>
                </div>
            </div>
            <div class="flex gap-2">
                <button id="withdrawBtn" class="w-12 h-12 bg-cyan-500/20 border border-cyan-500/50 text-cyan-400 rounded-[20px] flex items-center justify-center text-xl shadow-[0_0_15px_rgba(34,211,238,0.2)] active:scale-95 transition-all">ğŸ’¸</button>
                <button id="garageBtn" class="w-12 h-12 bg-indigo-500/20 border border-indigo-500/50 text-indigo-400 rounded-[20px] flex items-center justify-center text-xl shadow-[0_0_15px_rgba(99,102,241,0.2)] active:scale-95 transition-all">ğŸ›’</button>
                <button id="topupBtn" class="w-12 h-12 bg-[#FFDD00]/20 border border-[#FFDD00]/50 text-[#FFDD00] rounded-[20px] flex items-center justify-center text-xl shadow-[0_0_15px_rgba(255,221,0,0.2)] active:scale-95 transition-all">â˜•</button>
            </div>
        </div>

        <div class="px-4 z-30 mb-2 shrink-0">
            <div class="glass-panel border-blue-500/30 rounded-[20px] p-3 text-xs text-blue-100 flex items-center gap-3">
                <div class="w-7 h-7 rounded-full bg-blue-500/20 flex items-center justify-center border border-blue-500/40 shadow-[0_0_10px_rgba(59,130,246,0.5)] shrink-0"><span id="aiIcon" class="text-[10px]">ğŸ¤–</span></div>
                <span id="aiTipText" class="truncate w-full italic font-light" data-i18n="aiLoad">SÃ¼ni intellekt mÉ™slÉ™hÉ™ti yÃ¼klÉ™nir...</span>
            </div>
        </div>

        <div class="flex-1 w-full max-w-[400px] mx-auto relative glass-panel neon-box-cyan rounded-[40px] overflow-hidden z-10 flex shrink" id="gameContainer">
            <canvas id="gameCanvas" width="400" height="600" class="w-full h-full object-contain bg-[#0f172a]"></canvas>
            <div class="absolute inset-0 flex">
                <div id="laneLeft" class="flex-1 active:bg-white/5 cursor-pointer"></div>
                <div id="laneRight" class="flex-1 active:bg-white/5 cursor-pointer"></div>
            </div>

            <div id="demoReminder" class="hidden absolute top-10 left-4 right-4 z-[60] glass-panel p-5 rounded-3xl border border-[#facc15]/50 bg-[#0f172a]/95 text-center shadow-[0_0_30px_rgba(250,204,21,0.25)]">
                <h3 class="text-[#facc15] font-black text-sm mb-2 uppercase tracking-widest flex items-center justify-center gap-2"><span class="text-xl">âš ï¸</span> <span data-i18n="demoTitle">Demo Rejimi</span></h3>
                <p class="text-slate-200 text-xs leading-relaxed font-medium mb-4" data-i18n="demoText">BalansÄ±nÄ±za minimum mÉ™blÉ™ÄŸi yÃ¼klÉ™yin vÉ™ hesabÄ±nÄ±z aktiv hesab sayÄ±lsÄ±n. QazandÄ±ÄŸÄ±nÄ±z pul hÉ™qiqi olsun. HazÄ±rda oyun demo rejimindÉ™dir.</p>
                <button id="closeDemoReminder" class="w-full py-3 bg-[#facc15]/20 border border-[#facc15]/40 text-[#facc15] text-xs font-bold uppercase tracking-widest rounded-2xl active:scale-95 transition-all" data-i18n="btnGotIt">AnladÄ±m</button>
            </div>
            
            <div id="gameOverScreen" class="hidden absolute inset-0 bg-[#020617]/90 backdrop-blur-xl flex-col items-center justify-center p-8 text-center z-40">
                <div class="w-20 h-20 rounded-full bg-rose-500/20 flex items-center justify-center mb-4 blur-[2px] mx-auto"><span class="text-4xl">âš ï¸</span></div>
                <h2 id="gameOverTitle" class="text-3xl font-black text-rose-500 mb-2 neon-rose tracking-wider">GAME OVER</h2>
                <p class="text-slate-400 text-sm mb-2"><span data-i18n="lblDist">MÉ™safÉ™:</span> <span id="finalScore" class="font-bold text-white">0</span> M</p>
                
                <p id="gameOverMessage" class="text-rose-400 text-xs mb-6 hidden font-bold bg-rose-500/10 p-2 rounded-lg border border-rose-500/30" data-i18n="msgLocked">BalansÄ±nÄ±z bitdi! Oyun kilidlÉ™ndi. Davam etmÉ™k Ã¼Ã§Ã¼n balansÄ± artÄ±rÄ±n.</p>
                
                <button id="restartBtn" class="w-full py-4 bg-cyan-500/20 border border-cyan-500/50 text-cyan-300 rounded-[24px] font-bold uppercase tracking-widest shadow-[0_0_15px_rgba(34,211,238,0.2)] mb-4 active:scale-95 transition-all" data-i18n="btnRestart">YENÄ°DÆN BAÅLA</button>
                <button id="gameOverTopupBtn" class="hidden w-full py-4 bg-[#FFDD00] text-black rounded-[24px] font-bold uppercase tracking-widest shadow-[0_0_15px_rgba(255,221,0,0.3)] mb-4 active:scale-95 transition-all flex items-center justify-center gap-2"><span class="text-xl">â˜•</span> <span data-i18n="btnTopup">BALANSI ARTIR</span></button>
            </div>
        </div>

        <div class="w-full max-w-[400px] mx-auto p-4 pb-6 shrink-0 z-20">
            <button id="brakeBtn" class="w-full py-6 rounded-[32px] text-3xl font-black tracking-widest transition-all bg-rose-600 border-4 border-rose-800 text-white brake-shadow active:bg-rose-500 active:scale-95 touch-manipulation" data-i18n="btnBrake">TORMOZ</button>
        </div>
    </div>

    <div id="topUpModal" class="hidden absolute inset-0 bg-[#020617]/90 backdrop-blur-2xl flex items-center justify-center p-6 z-[100] overflow-y-auto">
        <div class="glass-panel p-6 rounded-[40px] text-center w-full max-w-md relative overflow-hidden my-auto">
            <h2 class="text-2xl font-black mb-4 neon-emerald relative z-10" data-i18n="topupTitle">BalansÄ± ArtÄ±r</h2>
            <div class="text-slate-300 text-xs mb-6 relative z-10 space-y-3 text-left bg-[#0f172a]/80 p-4 rounded-[20px] border border-white/5 shadow-inner">
                <p class="flex items-start gap-2"><span class="text-emerald-400 mt-0.5">âœ”</span><span><a href="https://buymeacoffee.com/surwin" target="_blank" class="text-[#FFDD00] underline font-bold">buymeacoffee.com/surwin</a> <span data-i18n="topupP1">linkinÉ™ daxil olaraq Ã¶dÉ™niÅŸ edin.</span></span></p>
                <p class="flex items-start gap-2"><span class="text-emerald-400 mt-0.5">âœ”</span><span data-i18n="topupP2">Balans bitdikdÉ™ yalnÄ±z mÉ™blÉ™ÄŸ yÃ¼klÉ™yÉ™rÉ™k oyuna davam edÉ™ bilÉ™rsiniz. (Ä°lk yoxlamada bonus verilÉ™cÉ™k)</span></p>
                <p class="flex items-start gap-2"><span class="text-emerald-400 mt-0.5">âœ”</span><span class="text-rose-300 font-bold" data-i18n="topupP3">Minimum mÉ™blÉ™ÄŸ 3 AZN-dir. ÆgÉ™r balansÄ± artÄ±rmadan oyuna davam etsÉ™niz, oyun DEMO sayÄ±lÄ±r vÉ™ Ã¶dÉ™niÅŸ olunmur. YalnÄ±z Ã¶dÉ™niÅŸ etdikdÉ™n sonra oyun tam aktiv olur, gerÃ§É™k pul qazana vÉ™ istÉ™diyiniz zaman naÄŸdlaÅŸdÄ±ra bilÉ™rsiniz.</span></p>
            </div>
            <button id="buyMeCoffeeBtn" class="w-full py-4 bg-[#FFDD00] text-black rounded-[24px] font-black shadow-[0_0_20px_rgba(255,221,0,0.3)] mb-4 active:scale-95 transition-all relative z-10 flex items-center justify-center gap-3 text-lg"><span class="text-2xl">â˜•</span> <span data-i18n="btnPay">Ã–dÉ™niÅŸ Et</span></button>
            <button id="verifyPaymentBtn" class="w-full py-3 bg-emerald-500/10 border border-emerald-500/30 text-emerald-400 rounded-[24px] font-bold mb-4 active:scale-95 transition-all relative z-10 text-sm flex items-center justify-center gap-2">ğŸ”„ <span data-i18n="btnVerify">Ã–dÉ™niÅŸi Yoxla</span></button>
            <button id="closeTopUpBtn" class="text-slate-400 text-[12px] font-bold uppercase tracking-widest active:text-white transition-all relative z-10" data-i18n="btnClose">BaÄŸla</button>
        </div>
    </div>

    <div id="withdrawModal" class="hidden absolute inset-0 bg-[#020617]/90 backdrop-blur-2xl flex items-center justify-center p-6 z-[100]">
        <div class="glass-panel p-8 rounded-[40px] text-center w-full max-w-sm relative overflow-hidden">
            <h2 class="text-2xl font-black mb-2 neon-cyan relative z-10" data-i18n="withTitle">NaÄŸdlaÅŸdÄ±r</h2>
            <div class="bg-[#0f172a] p-4 rounded-2xl mb-6 border border-white/5 relative z-10">
                <p class="text-[10px] text-slate-400 uppercase tracking-widest mb-1" data-i18n="lblCurBal">Cari BalansÄ±nÄ±z</p>
                <p id="withdrawBalanceDisplay" class="text-2xl font-black text-cyan-400 neon-cyan">0.00 AZN</p>
            </div>
            <form id="withdrawForm" action="BURA_LÄ°NKÄ°_YAPIÅDIRACAQSINIZ" method="POST" class="flex flex-col gap-3 relative z-10">
                <input type="hidden" name="MÃ¼ÅŸtÉ™rinin_BalansÄ±" id="hiddenBalanceInput" value="">
                <input type="text" name="Ad_Soyad" data-i18n-ph="phWName" placeholder="Ad vÉ™ SoyadÄ±nÄ±z" required class="w-full p-4 rounded-2xl bg-[#020617] border border-slate-700 text-white outline-none focus:border-cyan-500 text-sm">
                <input type="text" name="Kart_Nomresi" data-i18n-ph="phWCard" placeholder="Kart vÉ™ ya Hesab NÃ¶mrÉ™si" required class="w-full p-4 rounded-2xl bg-[#020617] border border-slate-700 text-white outline-none focus:border-cyan-500 text-sm">
                <p id="withdrawWarning" class="text-rose-500 text-xs font-bold mt-1 hidden" data-i18n="warnWith">BalansÄ±nÄ±z kifayÉ™t etmir.</p>
                <button type="submit" id="submitWithdrawBtn" class="w-full py-4 mt-2 bg-cyan-500/20 border border-cyan-500/50 text-cyan-400 rounded-[24px] font-bold uppercase tracking-widest shadow-[0_0_15px_rgba(34,211,238,0.2)] active:scale-95 transition-all" data-i18n="btnSubmit">SorÄŸu GÃ¶ndÉ™r</button>
            </form>
            <button id="closeWithdrawBtn" class="text-slate-400 text-[12px] font-bold uppercase tracking-widest mt-6 active:text-white transition-all relative z-10" data-i18n="btnBack">Geri</button>
        </div>
    </div>

    <div id="garageModal" class="hidden absolute inset-0 bg-[#020617]/90 backdrop-blur-2xl flex flex-col items-center justify-center p-6 z-[100]">
        <div class="glass-panel p-6 rounded-[32px] w-full max-w-sm relative overflow-hidden flex flex-col max-h-[90%]">
            <div class="flex justify-between items-center mb-6 relative z-10">
                <h2 class="text-2xl font-black neon-cyan italic" data-i18n="garageTitle">QARAJ</h2>
                <div class="text-right">
                    <p class="text-[10px] text-cyan-400 uppercase tracking-widest" data-i18n="hudBal">Balans</p>
                    <p id="garageBalanceText" class="text-sm font-bold neon-cyan">0.00 AZN</p>
                </div>
            </div>
            <div id="garageList" class="flex-1 overflow-y-auto pr-2 space-y-4 relative z-10 custom-scrollbar"></div>
            <button id="closeGarageBtn" class="w-full mt-6 py-4 glass-panel rounded-[20px] text-slate-300 font-bold uppercase tracking-widest active:scale-95 transition-all relative z-10" data-i18n="btnClose">BaÄŸla</button>
        </div>
    </div>

    <script>
        // DOM yÃ¼klÉ™nÉ™n kimi iÅŸÉ™ dÃ¼ÅŸmÉ™si Ã¼Ã§Ã¼n hÉ™r ÅŸeyi bir funksiyaya yÄ±ÄŸÄ±rÄ±q
        document.addEventListener('DOMContentLoaded', () => {

            const API_KEY = "SÄ°ZÄ°N_API_AÃ‡ARINIZI_BURAYA_YAPIÅDIRIN"; 
            
            function addEvt(id, event, handler) {
                const el = document.getElementById(id);
                if (el) el.addEventListener(event, handler);
            }

            const LANGUAGES = {
                az: { code: 'az', name: 'AzÉ™rbaycan', flag: 'ğŸ‡¦ğŸ‡¿', currency: 'AZN', rate: 1.0, dir: 'ltr', tts: 'tr-TR', 
                    t: { regTitle:"QEYDÄ°YYAT", rulesTitle:"QAYDALAR:", rule1:"â€¢ HÉ™r bir istifadÉ™Ã§i yalnÄ±z 1 dÉ™fÉ™ qeydiyyatdan keÃ§É™ bilÉ™r.", rule2:"â€¢ Eyni cihazdan birdÉ™n Ã§ox hesab yaradÄ±larsa, sistem avtomatik ban edÉ™cÉ™k.", rule3:"â€¢ SÄ±fÄ±r balansla oyuna baÅŸlamaq qadaÄŸandÄ±r.", phName:"Ad vÉ™ Soyad", phUser:"Ä°stifadÉ™Ã§i AdÄ±", phAge:"YaÅŸ", phPass:"ÅifrÉ™ (Min. 6 simvol)", btnReg:"QEYDÄ°YYATDAN KEÃ‡", hasAcc:"HesabÄ±nÄ±z var?", btnLoginNav:"Daxil olun", logTitle:"GÄ°RÄ°Å", phPass2:"ÅifrÉ™", errLogin:"MÉ™lumatlar yanlÄ±ÅŸdÄ±r!", btnLog:"DAXÄ°L OL", noAcc:"HesabÄ±nÄ±z yoxdur?", btnRegNav:"Qeydiyyat", banTitle:"HESAB BLOKLANDI", banText:"SistemdÉ™ Ã§oxlu hesab yaratmaÄŸa cÉ™hd etdiyiniz Ã¼Ã§Ã¼n cihazÄ±nÄ±z bloklanmÄ±ÅŸdÄ±r.", lblBal:"Balans:", btnStart:"Oyuna BaÅŸla", btnTopup:"BalansÄ± ArtÄ±r", hudBal:"Balans", hudDist:"MÉ™safÉ™", aiLoad:"SÃ¼ni intellekt mÉ™slÉ™hÉ™ti yÃ¼klÉ™nir...", demoTitle:"Demo Rejimi", demoText:"BalansÄ±nÄ±za minimum mÉ™blÉ™ÄŸi yÃ¼klÉ™yin vÉ™ hesabÄ±nÄ±z aktiv hesab sayÄ±lsÄ±n. QazandÄ±ÄŸÄ±nÄ±z pul hÉ™qiqi olsun. HazÄ±rda oyun demo rejimindÉ™dir.", btnGotIt:"AnladÄ±m", lblDist:"MÉ™safÉ™:", msgLocked:"BalansÄ±nÄ±z bitdi! Oyun kilidlÉ™ndi. Davam etmÉ™k Ã¼Ã§Ã¼n balansÄ± artÄ±rÄ±n.", btnRestart:"YENÄ°DÆN BAÅLA", btnBrake:"TORMOZ", topupTitle:"BalansÄ± ArtÄ±r", topupP1:"linkinÉ™ daxil olaraq Ã¶dÉ™niÅŸ edin.", topupP2:"Balans bitdikdÉ™ yalnÄ±z mÉ™blÉ™ÄŸ yÃ¼klÉ™yÉ™rÉ™k oyuna davam edÉ™ bilÉ™rsiniz. (Ä°lk yoxlamada bonus verilÉ™cÉ™k)", topupP3:"Minimum mÉ™blÉ™ÄŸ 3 AZN-dir. ÆgÉ™r balansÄ± artÄ±rmadan oyuna davam etsÉ™niz, oyun DEMO sayÄ±lÄ±r vÉ™ Ã¶dÉ™niÅŸ olunmur. YalnÄ±z Ã¶dÉ™niÅŸ etdikdÉ™n sonra oyun tam aktiv olur, gerÃ§É™k pul qazana vÉ™ naÄŸdlaÅŸdÄ±ra bilÉ™rsiniz.", btnPay:"Ã–dÉ™niÅŸ Et", btnVerify:"Ã–dÉ™niÅŸi Yoxla", btnClose:"BaÄŸla", withTitle:"NaÄŸdlaÅŸdÄ±r", lblCurBal:"Cari BalansÄ±nÄ±z", phWName:"Ad vÉ™ SoyadÄ±nÄ±z", phWCard:"Kart vÉ™ ya Hesab NÃ¶mrÉ™si", warnWith:"BalansÄ±nÄ±z kifayÉ™t etmir (Min: 30 AZN).", btnSubmit:"SorÄŸu GÃ¶ndÉ™r", btnBack:"Geri", garageTitle:"QARAJ", btnSel:"SeÃ§", btnSelected:"SeÃ§ilib", btnBuy:"Al", 
                    msgFine:"QÄ±rmÄ±zÄ± iÅŸÄ±q cÉ™rimÉ™si!", msgStop:"PolisÉ™ tabe olmadÄ±n!", msgCrash:"QÉ™za!", msgDanger:"TÉ™hlÃ¼kÉ™li!", msgWait:"GÃ¶zlÉ™, yoxlanÄ±ÅŸ...", msgGo:"Davam et!", msgLock:"Oyun kilidlÉ™ndi!", msgPause:"Oyun dayandÄ±rÄ±ldÄ±.", msgNoBal:"Balans bitib, artÄ±rmalÄ±san!", msgGas:"Qaza bas!", msgNewCar:"Yeni maÅŸÄ±n!", msgPaySuccess:"Ã–dÉ™niÅŸ uÄŸurlu! Davam et!" }
                },
                en: { code: 'en', name: 'English', flag: 'ğŸ‡¬ğŸ‡§', currency: 'USD', rate: 0.59, dir: 'ltr', tts: 'en-US',
                    t: { regTitle:"REGISTER", rulesTitle:"RULES:", rule1:"â€¢ Each user can register only once.", rule2:"â€¢ Multiple accounts from the same device will result in an auto-ban.", rule3:"â€¢ Starting the game with zero balance is forbidden.", phName:"Full Name", phUser:"Username", phAge:"Age", phPass:"Password (Min. 6 chars)", btnReg:"SIGN UP", hasAcc:"Have an account?", btnLoginNav:"Log in", logTitle:"LOGIN", phPass2:"Password", errLogin:"Invalid credentials!", btnLog:"LOGIN", noAcc:"Don't have an account?", btnRegNav:"Register", banTitle:"ACCOUNT BANNED", banText:"Your device has been banned due to multiple account creation attempts.", lblBal:"Balance:", btnStart:"Start Game", btnTopup:"Top Up", hudBal:"Balance", hudDist:"Distance", aiLoad:"Loading AI advice...", demoTitle:"Demo Mode", demoText:"Top up the minimum amount to activate your account. Earned money will be real. The game is currently in demo mode.", btnGotIt:"Got It", lblDist:"Distance:", msgLocked:"Out of balance! Game locked. Top up to continue.", btnRestart:"RESTART", btnBrake:"BRAKE", topupTitle:"Top Up Balance", topupP1:"link to make a payment.", topupP2:"When balance ends, you can only continue by adding funds. (Bonus on first check)", topupP3:"Minimum amount is equivalent to 3 AZN. If you continue without topping up, the game is DEMO and no payouts are made. Only after the payment your account becomes active to earn and withdraw real money.", btnPay:"Pay Now", btnVerify:"Verify Payment", btnClose:"Close", withTitle:"Withdraw", lblCurBal:"Current Balance", phWName:"Your Full Name", phWCard:"Card or Account Number", warnWith:"Insufficient balance.", btnSubmit:"Submit Request", btnBack:"Back", garageTitle:"GARAGE", btnSel:"Select", btnSelected:"Selected", btnBuy:"Buy", 
                    msgFine:"Red light fine!", msgStop:"Ignored the police!", msgCrash:"Crash!", msgDanger:"Near miss!", msgWait:"Wait, inspecting...", msgGo:"Proceed!", msgLock:"Game Locked!", msgPause:"Game Paused.", msgNoBal:"Out of balance, top up!", msgGas:"Hit the gas!", msgNewCar:"New car!", msgPaySuccess:"Payment successful! Continue!" }
                },
                uk: { code: 'uk', name: 'Ğ£ĞºÑ€Ğ°Ñ—Ğ½ÑÑŒĞºĞ°', flag: 'ğŸ‡ºğŸ‡¦', currency: 'UAH', rate: 23.0, dir: 'ltr', tts: 'uk-UA',
                    t: { regTitle:"Ğ Ğ•Ğ„Ğ¡Ğ¢Ğ ĞĞ¦Ğ†Ğ¯", rulesTitle:"ĞŸĞ ĞĞ’Ğ˜Ğ›Ğ:", rule1:"â€¢ Ğ›Ğ¸ÑˆĞµ 1 Ğ°ĞºĞ°ÑƒĞ½Ñ‚ Ğ½Ğ° ĞºĞ¾Ñ€Ğ¸ÑÑ‚ÑƒĞ²Ğ°Ñ‡Ğ°.", rule2:"â€¢ ĞšÑ–Ğ»ÑŒĞºĞ° Ğ°ĞºĞ°ÑƒĞ½Ñ‚Ñ–Ğ² = Ğ‘Ğ°Ğ½.", rule3:"â€¢ Ğ¡Ñ‚Ğ°Ñ€Ñ‚ Ğ· Ğ½ÑƒĞ»ÑŒĞ¾Ğ²Ğ¸Ğ¼ Ğ±Ğ°Ğ»Ğ°Ğ½ÑĞ¾Ğ¼ Ğ·Ğ°Ğ±Ğ¾Ñ€Ğ¾Ğ½ĞµĞ½Ğ¾.", phName:"Ğ†Ğ¼'Ñ Ñ‚Ğ° ĞŸÑ€Ñ–Ğ·Ğ²Ğ¸Ñ‰Ğµ", phUser:"Ğ†Ğ¼'Ñ ĞºĞ¾Ñ€Ğ¸ÑÑ‚ÑƒĞ²Ğ°Ñ‡Ğ°", phAge:"Ğ’Ñ–Ğº", phPass:"ĞŸĞ°Ñ€Ğ¾Ğ»ÑŒ (ĞœÑ–Ğ½. 6 ÑĞ¸Ğ¼Ğ².)", btnReg:"Ğ—ĞĞ Ğ•Ğ„Ğ¡Ğ¢Ğ Ğ£Ğ’ĞĞ¢Ğ˜Ğ¡Ğ¯", hasAcc:"Ğ„ Ğ°ĞºĞ°ÑƒĞ½Ñ‚?", btnLoginNav:"Ğ£Ğ²Ñ–Ğ¹Ñ‚Ğ¸", logTitle:"Ğ’Ğ¥Ğ†Ğ”", phPass2:"ĞŸĞ°Ñ€Ğ¾Ğ»ÑŒ", errLogin:"ĞĞµĞ²Ñ–Ñ€Ğ½Ñ– Ğ´Ğ°Ğ½Ñ–!", btnLog:"Ğ£Ğ’Ğ†Ğ™Ğ¢Ğ˜", noAcc:"ĞĞµĞ¼Ğ°Ñ” Ğ°ĞºĞ°ÑƒĞ½Ñ‚Ñƒ?", btnRegNav:"Ğ ĞµÑ”ÑÑ‚Ñ€Ğ°Ñ†Ñ–Ñ", banTitle:"Ğ—ĞĞ‘Ğ›ĞĞšĞĞ’ĞĞĞ", banText:"Ğ’Ğ°Ñˆ Ğ¿Ñ€Ğ¸ÑÑ‚Ñ€Ñ–Ğ¹ Ğ·Ğ°Ğ±Ğ»Ğ¾ĞºĞ¾Ğ²Ğ°Ğ½Ğ¾ Ñ‡ĞµÑ€ĞµĞ· ÑĞ¿Ñ€Ğ¾Ğ±Ğ¸ ÑÑ‚Ğ²Ğ¾Ñ€ĞµĞ½Ğ½Ñ ĞºÑ–Ğ»ÑŒĞºĞ¾Ñ… Ğ°ĞºĞ°ÑƒĞ½Ñ‚Ñ–Ğ².", lblBal:"Ğ‘Ğ°Ğ»Ğ°Ğ½Ñ:", btnStart:"ĞŸĞ¾Ñ‡Ğ°Ñ‚Ğ¸ Ğ“Ñ€Ñƒ", btnTopup:"ĞŸĞ¾Ğ¿Ğ¾Ğ²Ğ½Ğ¸Ñ‚Ğ¸", hudBal:"Ğ‘Ğ°Ğ»Ğ°Ğ½Ñ", hudDist:"Ğ”Ğ¸ÑÑ‚Ğ°Ğ½Ñ†Ñ–Ñ", aiLoad:"Ğ—Ğ°Ğ²Ğ°Ğ½Ñ‚Ğ°Ğ¶ĞµĞ½Ğ½Ñ Ğ¿Ğ¾Ñ€Ğ°Ğ´Ğ¸ Ğ¨Ğ†...", demoTitle:"Ğ”ĞµĞ¼Ğ¾-Ñ€ĞµĞ¶Ğ¸Ğ¼", demoText:"ĞŸĞ¾Ğ¿Ğ¾Ğ²Ğ½Ñ–Ñ‚ÑŒ Ğ±Ğ°Ğ»Ğ°Ğ½Ñ, Ñ‰Ğ¾Ğ± Ğ°ĞºÑ‚Ğ¸Ğ²ÑƒĞ²Ğ°Ñ‚Ğ¸ Ğ°ĞºĞ°ÑƒĞ½Ñ‚. Ğ—Ğ°Ñ€Ğ¾Ğ±Ğ»ĞµĞ½Ñ– Ğ³Ñ€Ğ¾ÑˆÑ– ÑÑ‚Ğ°Ğ½ÑƒÑ‚ÑŒ Ñ€ĞµĞ°Ğ»ÑŒĞ½Ğ¸Ğ¼Ğ¸. Ğ—Ğ°Ñ€Ğ°Ğ· Ğ´ĞµĞ¼Ğ¾-Ñ€ĞµĞ¶Ğ¸Ğ¼.", btnGotIt:"Ğ—Ñ€Ğ¾Ğ·ÑƒĞ¼Ñ–Ğ»Ğ¾", lblDist:"Ğ”Ğ¸ÑÑ‚Ğ°Ğ½Ñ†Ñ–Ñ:", msgLocked:"Ğ‘Ğ°Ğ»Ğ°Ğ½Ñ Ğ²Ğ¸Ñ‡ĞµÑ€Ğ¿Ğ°Ğ½Ğ¾! Ğ—Ğ°Ğ±Ğ»Ğ¾ĞºĞ¾Ğ²Ğ°Ğ½Ğ¾. ĞŸĞ¾Ğ¿Ğ¾Ğ²Ğ½Ñ–Ñ‚ÑŒ Ğ±Ğ°Ğ»Ğ°Ğ½Ñ.", btnRestart:"Ğ Ğ•Ğ¡Ğ¢ĞĞ Ğ¢", btnBrake:"Ğ“ĞĞ›Ğ¬ĞœĞ", topupTitle:"ĞŸĞ¾Ğ¿Ğ¾Ğ²Ğ½Ğ¸Ñ‚Ğ¸ Ğ±Ğ°Ğ»Ğ°Ğ½Ñ", topupP1:"Ğ¿Ğ¾ÑĞ¸Ğ»Ğ°Ğ½Ğ½Ñ Ğ´Ğ»Ñ Ğ¾Ğ¿Ğ»Ğ°Ñ‚Ğ¸.", topupP2:"Ğ¯ĞºÑ‰Ğ¾ Ğ±Ğ°Ğ»Ğ°Ğ½Ñ Ğ·Ğ°ĞºÑ–Ğ½Ñ‡Ğ¸Ñ‚ÑŒÑÑ, Ğ¿Ğ¾Ğ¿Ğ¾Ğ²Ğ½Ñ–Ñ‚ÑŒ Ğ¹Ğ¾Ğ³Ğ¾ Ğ´Ğ»Ñ Ğ¿Ñ€Ğ¾Ğ´Ğ¾Ğ²Ğ¶ĞµĞ½Ğ½Ñ.", topupP3:"Ğ‘ĞµĞ· Ğ¿Ğ¾Ğ¿Ğ¾Ğ²Ğ½ĞµĞ½Ğ½Ñ Ğ³Ñ€Ğ° Ğ²Ğ²Ğ°Ğ¶Ğ°Ñ”Ñ‚ÑŒÑÑ Ğ”Ğ•ĞœĞ. ĞŸÑ–ÑĞ»Ñ Ğ¿Ğ¾Ğ¿Ğ¾Ğ²Ğ½ĞµĞ½Ğ½Ñ Ğ°ĞºĞ°ÑƒĞ½Ñ‚ Ğ°ĞºÑ‚Ğ¸Ğ²ÑƒÑ”Ñ‚ÑŒÑÑ Ğ´Ğ»Ñ Ğ·Ğ°Ñ€Ğ¾Ğ±Ñ–Ñ‚ĞºÑƒ.", btnPay:"ĞĞ¿Ğ»Ğ°Ñ‚Ğ¸Ñ‚Ğ¸", btnVerify:"ĞŸĞµÑ€ĞµĞ²Ñ–Ñ€Ğ¸Ñ‚Ğ¸ Ğ¾Ğ¿Ğ»Ğ°Ñ‚Ñƒ", btnClose:"Ğ—Ğ°ĞºÑ€Ğ¸Ñ‚Ğ¸", withTitle:"Ğ’Ğ¸Ğ²ĞµĞ´ĞµĞ½Ğ½Ñ", lblCurBal:"ĞŸĞ¾Ñ‚Ğ¾Ñ‡Ğ½Ğ¸Ğ¹ Ğ±Ğ°Ğ»Ğ°Ğ½Ñ", phWName:"Ğ’Ğ°ÑˆĞµ Ğ†Ğ¼'Ñ", phWCard:"ĞĞ¾Ğ¼ĞµÑ€ ĞºĞ°Ñ€Ñ‚ĞºĞ¸ Ğ°Ğ±Ğ¾ Ñ€Ğ°Ñ…ÑƒĞ½ĞºÑƒ", warnWith:"ĞĞµĞ´Ğ¾ÑÑ‚Ğ°Ñ‚Ğ½ÑŒĞ¾ ĞºĞ¾ÑˆÑ‚Ñ–Ğ².", btnSubmit:"ĞĞ°Ğ´Ñ–ÑĞ»Ğ°Ñ‚Ğ¸ Ğ·Ğ°Ğ¿Ğ¸Ñ‚", btnBack:"ĞĞ°Ğ·Ğ°Ğ´", garageTitle:"Ğ“ĞĞ ĞĞ–", btnSel:"ĞĞ±Ñ€Ğ°Ñ‚Ğ¸", btnSelected:"ĞĞ±Ñ€Ğ°Ğ½Ğ¾", btnBuy:"ĞšÑƒĞ¿Ğ¸Ñ‚Ğ¸", 
                    msgFine:"Ğ¨Ñ‚Ñ€Ğ°Ñ„ Ğ·Ğ° Ñ‡ĞµÑ€Ğ²Ğ¾Ğ½Ğµ ÑĞ²Ñ–Ñ‚Ğ»Ğ¾!", msgStop:"Ğ†Ğ³Ğ½Ğ¾Ñ€ÑƒĞ²Ğ°Ğ½Ğ½Ñ Ğ¿Ğ¾Ğ»Ñ–Ñ†Ñ–Ñ—!", msgCrash:"ĞĞ²Ğ°Ñ€Ñ–Ñ!", msgDanger:"ĞĞµĞ±ĞµĞ·Ğ¿ĞµÑ‡Ğ½Ğ¾!", msgWait:"Ğ§ĞµĞºĞ°Ğ¹, Ğ¿ĞµÑ€ĞµĞ²Ñ–Ñ€ĞºĞ°...", msgGo:"ĞŸÑ€Ğ¾Ğ´Ğ¾Ğ²Ğ¶ÑƒĞ¹!", msgLock:"Ğ“Ñ€Ğ° Ğ·Ğ°Ğ±Ğ»Ğ¾ĞºĞ¾Ğ²Ğ°Ğ½Ğ°!", msgPause:"Ğ“Ñ€Ñƒ Ğ·ÑƒĞ¿Ğ¸Ğ½ĞµĞ½Ğ¾.", msgNoBal:"ĞĞµĞ¼Ğ°Ñ” Ğ±Ğ°Ğ»Ğ°Ğ½ÑÑƒ, Ğ¿Ğ¾Ğ¿Ğ¾Ğ²Ğ½Ğ¸!", msgGas:"Ğ¢Ğ¸ÑĞ½Ğ¸ Ğ½Ğ° Ğ³Ğ°Ğ·!", msgNewCar:"ĞĞ¾Ğ²Ğ° Ğ¼Ğ°ÑˆĞ¸Ğ½Ğ°!", msgPaySuccess:"ĞĞ¿Ğ»Ğ°Ñ‚Ğ° ÑƒÑĞ¿Ñ–ÑˆĞ½Ğ°! ĞŸÑ€Ğ¾Ğ´Ğ¾Ğ²Ğ¶ÑƒĞ¹!" }
                },
                ru: { code: 'ru', name: 'Ğ ÑƒÑÑĞºĞ¸Ğ¹', flag: 'ğŸ‡·ğŸ‡º', currency: 'RUB', rate: 55.0, dir: 'ltr', tts: 'ru-RU',
                    t: { regTitle:"Ğ Ğ•Ğ“Ğ˜Ğ¡Ğ¢Ğ ĞĞ¦Ğ˜Ğ¯", rulesTitle:"ĞŸĞ ĞĞ’Ğ˜Ğ›Ğ:", rule1:"â€¢ ĞšĞ°Ğ¶Ğ´Ñ‹Ğ¹ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒ Ğ¼Ğ¾Ğ¶ĞµÑ‚ Ğ·Ğ°Ñ€ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒÑÑ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ 1 Ñ€Ğ°Ğ·.", rule2:"â€¢ Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ½ĞµÑĞºĞ¾Ğ»ÑŒĞºĞ¸Ñ… Ğ°ĞºĞºĞ°ÑƒĞ½Ñ‚Ğ¾Ğ² Ğ¿Ñ€Ğ¸Ğ²ĞµĞ´ĞµÑ‚ Ğº Ğ±Ğ°Ğ½Ñƒ.", rule3:"â€¢ ĞĞ°Ñ‡Ğ¸Ğ½Ğ°Ñ‚ÑŒ Ñ Ğ½ÑƒĞ»ĞµĞ²Ñ‹Ğ¼ Ğ±Ğ°Ğ»Ğ°Ğ½ÑĞ¾Ğ¼ Ğ·Ğ°Ğ¿Ñ€ĞµÑ‰ĞµĞ½Ğ¾.", phName:"Ğ˜Ğ¼Ñ Ğ¸ Ğ¤Ğ°Ğ¼Ğ¸Ğ»Ğ¸Ñ", phUser:"Ğ˜Ğ¼Ñ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ", phAge:"Ğ’Ğ¾Ğ·Ñ€Ğ°ÑÑ‚", phPass:"ĞŸĞ°Ñ€Ğ¾Ğ»ÑŒ (ĞœĞ¸Ğ½. 6 ÑĞ¸Ğ¼Ğ².)", btnReg:"Ğ—ĞĞ Ğ•Ğ“Ğ˜Ğ¡Ğ¢Ğ Ğ˜Ğ ĞĞ’ĞĞ¢Ğ¬Ğ¡Ğ¯", hasAcc:"Ğ•ÑÑ‚ÑŒ Ğ°ĞºĞºĞ°ÑƒĞ½Ñ‚?", btnLoginNav:"Ğ’Ğ¾Ğ¹Ñ‚Ğ¸", logTitle:"Ğ’Ğ¥ĞĞ”", phPass2:"ĞŸĞ°Ñ€Ğ¾Ğ»ÑŒ", errLogin:"ĞĞµĞ²ĞµÑ€Ğ½Ñ‹Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ!", btnLog:"Ğ’ĞĞ™Ğ¢Ğ˜", noAcc:"ĞĞµÑ‚ Ğ°ĞºĞºĞ°ÑƒĞ½Ñ‚Ğ°?", btnRegNav:"Ğ ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ", banTitle:"ĞĞšĞšĞĞ£ĞĞ¢ Ğ—ĞĞ‘Ğ›ĞĞšĞ˜Ğ ĞĞ’ĞĞ", banText:"Ğ’Ğ°ÑˆĞµ ÑƒÑÑ‚Ñ€Ğ¾Ğ¹ÑÑ‚Ğ²Ğ¾ Ğ·Ğ°Ğ±Ğ»Ğ¾ĞºĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¾ Ğ¸Ğ·-Ğ·Ğ° Ğ¿Ğ¾Ğ¿Ñ‹Ñ‚Ğ¾Ğº ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ñ Ğ½ĞµÑĞºĞ¾Ğ»ÑŒĞºĞ¸Ñ… Ğ°ĞºĞºĞ°ÑƒĞ½Ñ‚Ğ¾Ğ².", lblBal:"Ğ‘Ğ°Ğ»Ğ°Ğ½Ñ:", btnStart:"ĞĞ°Ñ‡Ğ°Ñ‚ÑŒ Ğ˜Ğ³Ñ€Ñƒ", btnTopup:"ĞŸĞ¾Ğ¿Ğ¾Ğ»Ğ½Ğ¸Ñ‚ÑŒ", hudBal:"Ğ‘Ğ°Ğ»Ğ°Ğ½Ñ", hudDist:"Ğ”Ğ¸ÑÑ‚Ğ°Ğ½Ñ†Ğ¸Ñ", aiLoad:"Ğ—Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ° Ğ˜Ğ˜-ÑĞ¾Ğ²ĞµÑ‚Ğ°...", demoTitle:"Ğ”ĞµĞ¼Ğ¾-Ñ€ĞµĞ¶Ğ¸Ğ¼", demoText:"ĞŸĞ¾Ğ¿Ğ¾Ğ»Ğ½Ğ¸Ñ‚Ğµ Ğ¼Ğ¸Ğ½Ğ¸Ğ¼Ğ°Ğ»ÑŒĞ½ÑƒÑ ÑÑƒĞ¼Ğ¼Ñƒ, Ñ‡Ñ‚Ğ¾Ğ±Ñ‹ Ğ°ĞºÑ‚Ğ¸Ğ²Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ°ĞºĞºĞ°ÑƒĞ½Ñ‚. Ğ—Ğ°Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ´ĞµĞ½ÑŒĞ³Ğ¸ ÑÑ‚Ğ°Ğ½ÑƒÑ‚ Ñ€ĞµĞ°Ğ»ÑŒĞ½Ñ‹Ğ¼Ğ¸. Ğ¡ĞµĞ¹Ñ‡Ğ°Ñ Ğ¸Ğ³Ñ€Ğ° Ğ² Ğ´ĞµĞ¼Ğ¾-Ñ€ĞµĞ¶Ğ¸Ğ¼Ğµ.", btnGotIt:"ĞŸĞ¾Ğ½ÑÑ‚Ğ½Ğ¾", lblDist:"Ğ”Ğ¸ÑÑ‚Ğ°Ğ½Ñ†Ğ¸Ñ:", msgLocked:"Ğ‘Ğ°Ğ»Ğ°Ğ½Ñ Ğ¸ÑÑ‡ĞµÑ€Ğ¿Ğ°Ğ½! Ğ˜Ğ³Ñ€Ğ° Ğ·Ğ°Ğ±Ğ»Ğ¾ĞºĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ°. ĞŸĞ¾Ğ¿Ğ¾Ğ»Ğ½Ğ¸Ñ‚Ğµ Ğ±Ğ°Ğ»Ğ°Ğ½Ñ.", btnRestart:"Ğ—ĞĞĞĞ’Ğ", btnBrake:"Ğ¢ĞĞ ĞœĞĞ—", topupTitle:"ĞŸĞ¾Ğ¿Ğ¾Ğ»Ğ½Ğ¸Ñ‚ÑŒ Ğ±Ğ°Ğ»Ğ°Ğ½Ñ", topupP1:"Ñ‡Ñ‚Ğ¾Ğ±Ñ‹ Ğ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²ĞµÑÑ‚Ğ¸ Ğ¾Ğ¿Ğ»Ğ°Ñ‚Ñƒ.", topupP2:"Ğ•ÑĞ»Ğ¸ Ğ±Ğ°Ğ»Ğ°Ğ½Ñ Ğ·Ğ°ĞºĞ¾Ğ½Ñ‡Ğ¸Ñ‚ÑÑ, Ğ¿Ñ€Ğ¾Ğ´Ğ¾Ğ»Ğ¶Ğ°Ğ¹Ñ‚Ğµ, Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ¸Ğ² ÑÑ€ĞµĞ´ÑÑ‚Ğ²Ğ°.", topupP3:"ĞŸÑ€Ğ¸ Ğ¿Ñ€Ğ¾Ğ´Ğ¾Ğ»Ğ¶ĞµĞ½Ğ¸Ğ¸ Ğ±ĞµĞ· Ğ¿Ğ¾Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ñ Ğ¸Ğ³Ñ€Ğ° ÑÑ‡Ğ¸Ñ‚Ğ°ĞµÑ‚ÑÑ Ğ”Ğ•ĞœĞ. ĞŸĞ¾ÑĞ»Ğµ Ğ¿Ğ¾Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ñ Ğ°ĞºĞºĞ°ÑƒĞ½Ñ‚ Ğ°ĞºÑ‚Ğ¸Ğ²Ğ¸Ñ€ÑƒĞµÑ‚ÑÑ Ğ´Ğ»Ñ Ğ·Ğ°Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ° Ğ¸ Ğ²Ñ‹Ğ²Ğ¾Ğ´Ğ°.", btnPay:"ĞĞ¿Ğ»Ğ°Ñ‚Ğ¸Ñ‚ÑŒ", btnVerify:"ĞŸÑ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ Ğ¾Ğ¿Ğ»Ğ°Ñ‚Ñƒ", btnClose:"Ğ—Ğ°ĞºÑ€Ñ‹Ñ‚ÑŒ", withTitle:"Ğ’Ñ‹Ğ²Ğ¾Ğ´ ÑÑ€ĞµĞ´ÑÑ‚Ğ²", lblCurBal:"Ğ¢ĞµĞºÑƒÑ‰Ğ¸Ğ¹ Ğ±Ğ°Ğ»Ğ°Ğ½Ñ", phWName:"Ğ’Ğ°ÑˆĞµ Ğ˜Ğ¼Ñ", phWCard:"ĞĞ¾Ğ¼ĞµÑ€ ĞºĞ°Ñ€Ñ‚Ñ‹ Ğ¸Ğ»Ğ¸ ÑÑ‡ĞµÑ‚Ğ°", warnWith:"ĞĞµĞ´Ğ¾ÑÑ‚Ğ°Ñ‚Ğ¾Ñ‡Ğ½Ğ¾ ÑÑ€ĞµĞ´ÑÑ‚Ğ².", btnSubmit:"ĞÑ‚Ğ¿Ñ€Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ğ·Ğ°Ğ¿Ñ€Ğ¾Ñ", btnBack:"ĞĞ°Ğ·Ğ°Ğ´", garageTitle:"Ğ“ĞĞ ĞĞ–", btnSel:"Ğ’Ñ‹Ğ±Ñ€Ğ°Ñ‚ÑŒ", btnSelected:"Ğ’Ñ‹Ğ±Ñ€Ğ°Ğ½Ğ¾", btnBuy:"ĞšÑƒĞ¿Ğ¸Ñ‚ÑŒ", 
                    msgFine:"Ğ¨Ñ‚Ñ€Ğ°Ñ„ Ğ·Ğ° ĞºÑ€Ğ°ÑĞ½Ñ‹Ğ¹ ÑĞ²ĞµÑ‚!", msgStop:"ĞĞµ Ğ¿Ğ¾Ğ´Ñ‡Ğ¸Ğ½Ğ¸Ğ»ÑÑ Ğ¿Ğ¾Ğ»Ğ¸Ñ†Ğ¸Ğ¸!", msgCrash:"ĞĞ²Ğ°Ñ€Ğ¸Ñ!", msgDanger:"ĞĞ¿Ğ°ÑĞ½Ğ¾!", msgWait:"Ğ–Ğ´Ğ¸, Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ°...", msgGo:"ĞŸÑ€Ğ¾Ğ´Ğ¾Ğ»Ğ¶Ğ°Ğ¹!", msgLock:"Ğ˜Ğ³Ñ€Ğ° Ğ·Ğ°Ğ±Ğ»Ğ¾ĞºĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ°!", msgPause:"Ğ˜Ğ³Ñ€Ğ° Ğ¾ÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ°.", msgNoBal:"ĞĞµÑ‚ Ğ±Ğ°Ğ»Ğ°Ğ½ÑĞ°, Ğ¿Ğ¾Ğ¿Ğ¾Ğ»Ğ½Ğ¸!", msgGas:"Ğ–Ğ¼Ğ¸ Ğ½Ğ° Ğ³Ğ°Ğ·!", msgNewCar:"ĞĞ¾Ğ²Ğ°Ñ Ğ¼Ğ°ÑˆĞ¸Ğ½Ğ°!", msgPaySuccess:"ĞĞ¿Ğ»Ğ°Ñ‚Ğ° Ğ¿Ñ€Ğ¾ÑˆĞ»Ğ°! ĞŸÑ€Ğ¾Ğ´Ğ¾Ğ»Ğ¶Ğ°Ğ¹!" }
                },
                tr: { code: 'tr', name: 'TÃ¼rkÃ§e', flag: 'ğŸ‡¹ğŸ‡·', currency: 'TRY', rate: 19.0, dir: 'ltr', tts: 'tr-TR',
                    t: { regTitle:"KAYIT OL", rulesTitle:"KURALLAR:", rule1:"â€¢ Her kullanÄ±cÄ± yalnÄ±zca 1 kez kayÄ±t olabilir.", rule2:"â€¢ AynÄ± cihazdan birden fazla hesap otomatik ban sebebidir.", rule3:"â€¢ SÄ±fÄ±r bakiye ile baÅŸlamak yasaktÄ±r.", phName:"Ad Soyad", phUser:"KullanÄ±cÄ± AdÄ±", phAge:"YaÅŸ", phPass:"Åifre (Min. 6 kar.)", btnReg:"KAYIT OL", hasAcc:"HesabÄ±n var mÄ±?", btnLoginNav:"GiriÅŸ yap", logTitle:"GÄ°RÄ°Å", phPass2:"Åifre", errLogin:"HatalÄ± bilgiler!", btnLog:"GÄ°RÄ°Å YAP", noAcc:"HesabÄ±n yok mu?", btnRegNav:"KayÄ±t Ol", banTitle:"HESAP ENGELLENDÄ°", banText:"Ã‡oklu hesap aÃ§ma giriÅŸimi nedeniyle cihazÄ±nÄ±z engellendi.", lblBal:"Bakiye:", btnStart:"Oyuna BaÅŸla", btnTopup:"Bakiye YÃ¼kle", hudBal:"Bakiye", hudDist:"Mesafe", aiLoad:"Yapay zeka tavsiyesi yÃ¼kleniyor...", demoTitle:"Demo Modu", demoText:"HesabÄ±nÄ±zÄ± aktif etmek iÃ§in minimum tutarÄ± yÃ¼kleyin. KazancÄ±nÄ±z gerÃ§ek olacaktÄ±r. Åu an oyun demo modunda.", btnGotIt:"AnladÄ±m", lblDist:"Mesafe:", msgLocked:"Bakiye bitti! Oyun kilitlendi. Devam etmek iÃ§in yÃ¼kleme yapÄ±n.", btnRestart:"YENÄ°DEN BAÅLA", btnBrake:"FREN", topupTitle:"Bakiye YÃ¼kle", topupP1:"linkinden Ã¶deme yapÄ±n.", topupP2:"Bakiye bittiÄŸinde sadece yÃ¼kleme yaparak devam edebilirsiniz.", topupP3:"YÃ¼kleme yapmadan devam ederseniz oyun DEMO sayÄ±lÄ±r. Ã–deme yaptÄ±ktan sonra gerÃ§ek para kazanÄ±p Ã§ekebilirsiniz.", btnPay:"Ã–deme Yap", btnVerify:"Ã–demeyi DoÄŸrula", btnClose:"Kapat", withTitle:"Para Ã‡ek", lblCurBal:"Mevcut Bakiye", phWName:"AdÄ±nÄ±z SoyadÄ±nÄ±z", phWCard:"Kart veya Hesap No", warnWith:"Bakiye yetersiz.", btnSubmit:"Talep GÃ¶nder", btnBack:"Geri", garageTitle:"GARAJ", btnSel:"SeÃ§", btnSelected:"SeÃ§ildi", btnBuy:"SatÄ±n Al", 
                    msgFine:"KÄ±rmÄ±zÄ± Ä±ÅŸÄ±k cezasÄ±!", msgStop:"Polise itaat etmedin!", msgCrash:"Kaza!", msgDanger:"Tehlikeli!", msgWait:"Bekle, denetim...", msgGo:"Devam et!", msgLock:"Oyun kilitlendi!", msgPause:"Oyun durduruldu.", msgNoBal:"Bakiye bitti, yÃ¼kle!", msgGas:"Gaza bas!", msgNewCar:"Yeni araba!", msgPaySuccess:"Ã–deme baÅŸarÄ±lÄ±! Devam!" }
                }
            };

            let currentLang = null;
            try { currentLang = localStorage.getItem('premiumDriveLang') || null; } catch(e) {}

            function applyTranslations() {
                if (!currentLang || !LANGUAGES[currentLang]) return;
                const langObj = LANGUAGES[currentLang];
                
                document.documentElement.lang = langObj.code;
                document.documentElement.dir = langObj.dir;
                
                const flagIcon = document.getElementById('currentFlagIcon');
                const currCode = document.getElementById('currentCurrCode');
                if(flagIcon) flagIcon.innerText = langObj.flag;
                if(currCode) currCode.innerText = langObj.currency;

                document.querySelectorAll('[data-i18n]').forEach(el => {
                    const key = el.getAttribute('data-i18n');
                    if (langObj.t[key]) el.innerText = langObj.t[key];
                });

                document.querySelectorAll('[data-i18n-ph]').forEach(el => {
                    const key = el.getAttribute('data-i18n-ph');
                    if (langObj.t[key]) el.setAttribute('placeholder', langObj.t[key]);
                });
                
                updateUI();
                const gModal = document.getElementById('garageModal');
                if(gModal && !gModal.classList.contains('hidden')) renderGarage();
            }

            function changeLanguage(code) {
                currentLang = code;
                try { localStorage.setItem('premiumDriveLang', code); } catch(e){}
                applyTranslations();
                checkAuthState(); 
            }

            function initLanguageModal() {
                const container = document.getElementById('langListContainer');
                if (!container) return;
                Object.values(LANGUAGES).forEach(l => {
                    const btn = document.createElement('button');
                    btn.className = "p-4 glass-panel rounded-2xl flex items-center justify-center gap-3 active:scale-95 transition-all text-white font-bold";
                    btn.innerHTML = `<span class="text-2xl">${l.flag}</span> <span>${l.name}</span>`;
                    btn.onclick = () => changeLanguage(l.code);
                    container.appendChild(btn);
                });
            }
            initLanguageModal();

            addEvt('langToggleBtn', 'click', () => {
                document.getElementById('langSelectModal').classList.remove('hidden');
                document.getElementById('globalLangSelector').classList.add('hidden');
            });

            const CAR_SKINS = [
                { id: 'default', name: 'Neon Blue', color: '#0ea5e9', price: 0, owned: true },
                { id: 'sport', name: 'Sport Red', color: '#f43f5e', price: 5.00, owned: false },
                { id: 'taxi', name: 'City Taxi', color: '#facc15', price: 10.00, owned: false },
                { id: 'vip', name: 'VIP Stealth', color: '#0f172a', price: 25.00, owned: false }
            ];
            
            const TRAFFIC_COLORS = ['#f43f5e', '#3b82f6', '#10b981', '#f59e0b', '#a855f7', '#cbd5e1', '#ea580c'];
            let activeSkinId = 'default';

            let audioCtx = null; let engineOsc = null; let engineGain = null;
            function initAudio() {
                if (audioCtx) return;
                try {
                    audioCtx = new (window.AudioContext || window.webkitAudioContext)();
                    engineOsc = audioCtx.createOscillator(); engineGain = audioCtx.createGain();
                    engineOsc.type = 'sawtooth'; engineOsc.frequency.setValueAtTime(40, audioCtx.currentTime);
                    engineGain.gain.setValueAtTime(0.08, audioCtx.currentTime); 
                    engineOsc.connect(engineGain); engineGain.connect(audioCtx.destination); engineOsc.start();
                } catch(e){}
            }
            function playTone(freq, type, duration, vol = 0.1) {
                if (!audioCtx) return;
                try {
                    const osc = audioCtx.createOscillator(); const gain = audioCtx.createGain();
                    osc.type = type; osc.frequency.setValueAtTime(freq, audioCtx.currentTime);
                    gain.gain.setValueAtTime(vol, audioCtx.currentTime);
                    gain.gain.exponentialRampToValueAtTime(0.001, audioCtx.currentTime + duration);
                    osc.connect(gain); gain.connect(audioCtx.destination); osc.start(); osc.stop(audioCtx.currentTime + duration);
                } catch(e){}
            }
            function playCrashSound() { playTone(150, 'sawtooth', 0.5, 0.4); setTimeout(() => playTone(50, 'square', 0.8, 0.4), 100); }
            function playSuccessSound() { playTone(660, 'sine', 0.1, 0.2); setTimeout(() => playTone(880, 'sine', 0.3, 0.2), 100); }
            function playFineSound() { playTone(200, 'square', 0.3, 0.3); setTimeout(() => playTone(150, 'square', 0.4, 0.3), 150); }
            function playBuySound() { playTone(523.25, 'sine', 0.1, 0.2); setTimeout(() => playTone(659.25, 'sine', 0.2, 0.2), 100); setTimeout(() => playTone(783.99, 'sine', 0.3, 0.2), 200); }
            function playNitroSound() { playTone(300, 'square', 0.1, 0.1); setTimeout(() => playTone(500, 'sawtooth', 0.5, 0.2), 100); }
            function playPoliceSiren() { playTone(800, 'sine', 0.3, 0.2); setTimeout(() => playTone(600, 'sine', 0.3, 0.2), 300); }

            function getSpeechData(text) {
                if ('speechSynthesis' in window && currentLang) {
                    window.speechSynthesis.cancel(); 
                    const utterance = new SpeechSynthesisUtterance(text);
                    utterance.lang = LANGUAGES[currentLang].tts; utterance.rate = 1.1; 
                    const aiIcon = document.getElementById("aiIcon");
                    utterance.onstart = () => { if(aiIcon) aiIcon.innerText = "ğŸ”Š"; };
                    utterance.onend = () => { if(aiIcon) aiIcon.innerText = "ğŸ¤–"; };
                    window.speechSynthesis.speak(utterance);
                }
            }

            // DÄ°QQÆT: SÃœNÄ° Ä°NTELLEKT BÄ°RBAÅA "FETCH" Ä°LÆ Ä°ÅLÆYÄ°R (SDK YOXDUR)
            async function getDrivingAdvice(scenario) {
                const aiTipEl = document.getElementById("aiTipText");
                if (!aiTipEl) return;
                
                const langName = currentLang ? LANGUAGES[currentLang].name : 'AzÉ™rbaycanca';
                const promptText = `SÉ™n oyunda sÉ™sli kÃ¶mÉ™kÃ§isÉ™n. Ssenari: ${scenario}. Ã‡ox hÉ™yÉ™canlÄ± vÉ™ maksimum 4 sÃ¶zlÃ¼k cavab ver. Dil: ${langName}.`;

                if (API_KEY === "SÄ°ZÄ°N_API_AÃ‡ARINIZI_BURAYA_YAPIÅDIRIN" || !API_KEY) {
                    aiTipEl.innerText = scenario;
                    getSpeechData(scenario);
                    return;
                }

                try {
                    const url = `https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${API_KEY}`;
                    const response = await fetch(url, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            contents: [{ parts: [{ text: promptText }] }]
                        })
                    });
                    const data = await response.json();
                    
                    if (data.candidates && data.candidates[0].content.parts[0].text) {
                        const text = data.candidates[0].content.parts[0].text.trim();
                        aiTipEl.innerText = text;
                        getSpeechData(text);
                    } else {
                        aiTipEl.innerText = scenario;
                        getSpeechData(scenario);
                    }
                } catch (error) { 
                    console.warn("AI XÉ™tasÄ±:", error); 
                    aiTipEl.innerText = scenario;
                    getSpeechData(scenario);
                }
            }

            function triggerScreenShake() {
                const container = document.getElementById('gameContainer');
                if(container){
                    container.classList.remove('shake-effect');
                    void container.offsetWidth; 
                    container.classList.add('shake-effect');
                }
            }

            let balance = 0.00;
            try {
                let savedBalance = localStorage.getItem('premiumDriveBalance');
                if (savedBalance !== null && !isNaN(parseFloat(savedBalance))) {
                    balance = parseFloat(savedBalance);
                }
            } catch(e){}

            let currentUser = null;
            try {
                let storedUser = localStorage.getItem('premiumDriveUser');
                if(storedUser && storedUser.includes("{")) {
                    currentUser = JSON.parse(storedUser);
                }
            } catch(e) {
                try { localStorage.removeItem('premiumDriveUser'); } catch(ex){} 
            }
            
            let isBanned = false;
            try { isBanned = localStorage.getItem('premiumDriveBan') === 'true'; } catch(e){}

            function hideAllScreens() {
                ['langSelectModal', 'authScreen', 'loginFormScreen', 'loginScreen', 'banScreen', 'gameScreen'].forEach(id => {
                    const el = document.getElementById(id);
                    if(el) el.classList.add('hidden');
                });
            }

            function checkAuthState() {
                hideAllScreens();
                
                if (!currentLang) {
                    const lsModal = document.getElementById('langSelectModal');
                    const gSel = document.getElementById('globalLangSelector');
                    if(lsModal) lsModal.classList.remove('hidden');
                    if(gSel) gSel.classList.add('hidden');
                    return;
                }
                
                const gSel = document.getElementById('globalLangSelector');
                if(gSel) gSel.classList.remove('hidden');

                if (isBanned) {
                    const banEl = document.getElementById('banScreen');
                    if(banEl) banEl.classList.remove('hidden');
                } else if (currentUser) {
                    const loginEl = document.getElementById('loginScreen');
                    if(loginEl) loginEl.classList.remove('hidden');
                    if(!isGameRunning) applyTranslations(); 
                } else {
                    const authEl = document.getElementById('authScreen');
                    if(authEl) authEl.classList.remove('hidden');
                }
            }

            if(currentLang) applyTranslations();
            checkAuthState(); 

            addEvt('showLoginBtn', 'click', () => {
                document.getElementById('authScreen').classList.add('hidden'); 
                document.getElementById('loginFormScreen').classList.remove('hidden');
            });
            
            addEvt('showRegisterBtn', 'click', () => {
                document.getElementById('loginFormScreen').classList.add('hidden'); 
                document.getElementById('authScreen').classList.remove('hidden');
            });

            addEvt('registerForm', 'submit', (e) => {
                e.preventDefault();
                let checkUser = null;
                try { checkUser = localStorage.getItem('premiumDriveUser'); } catch(e){}

                if (checkUser !== null) {
                    try { localStorage.setItem('premiumDriveBan', 'true'); } catch(e){}
                    isBanned = true;
                    checkAuthState(); 
                    return;
                }
                
                const fName = document.getElementById('regFullName');
                const uName = document.getElementById('regUsername');
                const uAge = document.getElementById('regAge');
                const uPass = document.getElementById('regPassword');

                currentUser = { 
                    fullName: fName ? fName.value : "", 
                    username: uName ? uName.value : "", 
                    age: uAge ? uAge.value : "", 
                    password: uPass ? uPass.value : "", 
                    bonusClaimed: false 
                };
                
                try {
                    localStorage.setItem('premiumDriveUser', JSON.stringify(currentUser));
                    localStorage.setItem('premiumDriveBalance', '0.00'); 
                } catch(e){}
                
                balance = 0.00;
                checkAuthState();
            });

            addEvt('loginUserForm', 'submit', (e) => {
                e.preventDefault();
                const logUName = document.getElementById('logUsername');
                const logPass = document.getElementById('logPassword');
                const errEl = document.getElementById('loginError');

                const userVal = logUName ? logUName.value : "";
                const passVal = logPass ? logPass.value : "";
                
                let savedUser = null;
                try { savedUser = JSON.parse(localStorage.getItem('premiumDriveUser')); } catch(e){}
                
                if (savedUser && savedUser.username === userVal && savedUser.password === passVal) {
                    currentUser = savedUser;
                    if(errEl) errEl.classList.add('hidden');
                    checkAuthState();
                } else {
                    if(errEl) errEl.classList.remove('hidden');
                }
            });

            const LOGICAL_WIDTH = 400; const LOGICAL_HEIGHT = 600;
            const CAR_WIDTH = 48; const CAR_HEIGHT = 86; const PLAYER_Y = LOGICAL_HEIGHT - 130;
            const LANES = [100, 200, 300]; const BIOMES = [{ ground: '#020617', road: '#0f172a', curb: '#1e293b' }];

            let isGameRunning = false; let isBraking = false; let isGameOver = false;
            let score = 0; let trafficCars = []; let speedMultiplier = 1; let animatedPopups = []; 
            let nitroTimer = 0; let screenShake = 0; let demoReminderTimeout;
            let gameState = { carX: LANES[1] - CAR_WIDTH / 2, targetX: LANES[1] - CAR_WIDTH / 2, linesOffset: 0 };
            let trafficLight = { active: false, y: -200, state: 'GREEN', timer: 0, passed: false };
            let policeEvent = { active: false, y: -200, passed: false, isWaiting: false };

            const canvas = document.getElementById('gameCanvas'); 
            const ctx = canvas ? canvas.getContext('2d') : null;

            function formatCurrency(baseAznValue) {
                const lang = LANGUAGES[currentLang] || LANGUAGES['az'];
                return (baseAznValue * lang.rate).toFixed(2) + ' ' + lang.currency;
            }

            function getT(key) {
                if(!currentLang || !LANGUAGES[currentLang]) return key;
                return LANGUAGES[currentLang].t[key] || key;
            }

            function safeSetText(id, text) {
                const el = document.getElementById(id);
                if(el) el.innerText = text;
            }

            function updateUI() {
                try { localStorage.setItem('premiumDriveBalance', balance.toFixed(2)); } catch(e){}
                const formatted = formatCurrency(balance);
                
                safeSetText('balanceText', formatted);
                safeSetText('loginBalanceText', formatted);
                safeSetText('garageBalanceText', formatted);
                safeSetText('withdrawBalanceDisplay', formatted);
                safeSetText('scoreText', `${Math.floor(score)} M`);
                
                const hInput = document.getElementById('hiddenBalanceInput');
                if(hInput) hInput.value = formatted;
                
                const submitBtn = document.getElementById('submitWithdrawBtn');
                const warning = document.getElementById('withdrawWarning');
                if(submitBtn && warning) {
                    if (balance < 30) { 
                        submitBtn.disabled = true; submitBtn.classList.add('opacity-50', 'cursor-not-allowed'); warning.classList.remove('hidden');
                    } else {
                        submitBtn.disabled = false; submitBtn.classList.remove('opacity-50', 'cursor-not-allowed'); warning.classList.add('hidden');
                    }
                }
            }

            function spawnPopup(text, color, x, y) { animatedPopups.push({ text, color, x, y, alpha: 1, life: 60 }); }

            window.selectCar = function(id) { activeSkinId = id; playSuccessSound(); renderGarage(); };
            window.buyCar = function(id) {
                const car = CAR_SKINS.find(c => c.id === id);
                if (car && balance >= car.price) {
                    balance -= car.price; car.owned = true; activeSkinId = id;
                    playBuySound(); updateUI(); renderGarage(); getDrivingAdvice(getT("msgNewCar"));
                }
            };

            function renderGarage() {
                const list = document.getElementById('garageList'); 
                if(!list) return;
                list.innerHTML = '';
                
                CAR_SKINS.forEach(car => {
                    const item = document.createElement('div'); 
                    item.className = "glass-panel p-4 rounded-[20px] flex items-center justify-between";
                    const isSelected = activeSkinId === car.id; let btnHTML = '';
                    if (car.owned) {
                        btnHTML = isSelected ? `<button disabled class="py-2 px-4 rounded-xl text-xs font-bold bg-cyan-500/10 text-cyan-500">${getT("btnSelected")}</button>` 
                        : `<button onclick="window.selectCar('${car.id}')" class="py-2 px-4 rounded-xl text-xs font-bold bg-cyan-500/20 text-cyan-300">${getT("btnSel")}</button>`;
                    } else {
                        const priceF = formatCurrency(car.price);
                        btnHTML = balance >= car.price ? `<button onclick="window.buyCar('${car.id}')" class="py-2 px-4 rounded-xl text-xs font-bold bg-emerald-500/20 text-emerald-400">${getT("btnBuy")} (${priceF})</button>`
                        : `<button disabled class="py-2 px-4 rounded-xl text-xs font-bold bg-slate-800/50 text-slate-500">${getT("btnBuy")} (${priceF})</button>`;
                    }
                    item.innerHTML = `<div class="flex items-center gap-4"><div class="w-12 h-12 rounded-xl flex items-center justify-center" style="background-color: ${car.color}"><div class="w-6 h-10 bg-black/20"></div></div><div><p class="font-bold text-sm">${car.name}</p></div></div><div>${btnHTML}</div>`;
                    list.appendChild(item);
                });
            }

            addEvt('closeDemoReminder', 'click', () => {
                document.getElementById('demoReminder').classList.add('hidden');
            });

            function startGame() {
                if (balance <= 0) {
                    document.getElementById('topUpModal').classList.remove('hidden');
                    getDrivingAdvice(getT("msgNoBal"));
                    return;
                }
                
                document.getElementById('loginScreen').classList.add('hidden'); 
                document.getElementById('gameScreen').classList.remove('hidden'); 
                document.getElementById('gameOverScreen').classList.add('hidden'); 
                document.getElementById('globalLangSelector').classList.add('hidden');
                
                initAudio(); isGameRunning = true; isGameOver = false; score = 0; speedMultiplier = 1; trafficCars = []; animatedPopups = [];
                nitroTimer = 0; screenShake = 0;
                gameState.carX = LANES[1] - CAR_WIDTH / 2; gameState.targetX = LANES[1] - CAR_WIDTH / 2; 
                trafficLight.active = false; policeEvent.active = false; policeEvent.isWaiting = false;
                
                clearTimeout(demoReminderTimeout); 
                document.getElementById('demoReminder').classList.add('hidden');
                
                demoReminderTimeout = setTimeout(() => {
                    if (isGameRunning && !isGameOver) {
                        document.getElementById('demoReminder').classList.remove('hidden');
                        playTone(600, 'square', 0.2, 0.2); 
                        getDrivingAdvice("HesabÄ± aktivlÉ™ÅŸdir!");
                    }
                }, 15000);

                updateUI(); getDrivingAdvice(getT("msgGas")); 
                if(ctx) requestAnimationFrame(gameLoop);
            }

            function gameOver() {
                isGameOver = true; 
                clearTimeout(demoReminderTimeout); 
                document.getElementById('demoReminder').classList.add('hidden'); 
                
                document.getElementById('gameOverScreen').classList.remove('hidden'); 
                document.getElementById('finalScore').innerText = Math.floor(score);
                document.getElementById('globalLangSelector').classList.remove('hidden');
                
                const restartBtn = document.getElementById('restartBtn'); 
                const topupBtn = document.getElementById('gameOverTopupBtn');
                const msg = document.getElementById('gameOverMessage'); 
                const title = document.getElementById('gameOverTitle');

                if(title && restartBtn && topupBtn && msg) {
                    if (balance <= 0) {
                        title.innerText = getT("msgLock").toUpperCase(); title.classList.replace('text-rose-500', 'text-red-600'); 
                        restartBtn.classList.add('hidden'); topupBtn.classList.remove('hidden'); 
                        msg.innerText = getT("msgLocked"); msg.classList.remove('hidden');
                        getDrivingAdvice(getT("msgLock")); 
                    } else {
                        title.innerText = "GAME OVER"; title.classList.replace('text-red-600', 'text-rose-500');
                        restartBtn.classList.remove('hidden'); topupBtn.classList.add('hidden'); msg.classList.add('hidden');
                        getDrivingAdvice(getT("msgPause")); 
                    }
                }
                if (engineGain && audioCtx) engineGain.gain.setTargetAtTime(0, audioCtx.currentTime, 0.1);
            }

            function update() {
                if (!isGameRunning || isGameOver) return;
                
                let currentBaseSpeed = 5; if (nitroTimer > 0) { currentBaseSpeed += 6; nitroTimer--; }
                const baseSpeed = (isBraking || policeEvent.isWaiting) ? 0 : currentBaseSpeed * speedMultiplier; 
                if (!isBraking && !policeEvent.isWaiting) { score += (nitroTimer > 0 ? 0.3 : 0.1) * speedMultiplier; } 
                gameState.linesOffset = (gameState.linesOffset + baseSpeed) % 80; gameState.carX += (gameState.targetX - gameState.carX) * 0.15;
                if (screenShake > 0) screenShake--;

                // Ä°ÅIQFOR
                if (!trafficLight.active && !policeEvent.active && Math.random() < 0.005 && score > 10) { trafficLight.active = true; trafficLight.y = -100; trafficLight.passed = false; trafficLight.timer = 300; trafficLight.state = 'GREEN'; }
                if (trafficLight.active) {
                    trafficLight.y += baseSpeed; trafficLight.timer--;
                    if (trafficLight.timer === 200) trafficLight.state = 'YELLOW';
                    if (trafficLight.timer === 140) trafficLight.state = 'RED';
                    if (trafficLight.timer === 0) trafficLight.state = 'GREEN';

                    if (trafficLight.y > PLAYER_Y + CAR_HEIGHT && !trafficLight.passed) {
                        trafficLight.passed = true;
                        if (trafficLight.state === 'RED' && !isBraking) { 
                            balance -= 0.60; playFineSound(); triggerScreenShake(); screenShake = 15;
                            spawnPopup("- " + formatCurrency(0.60), "#f43f5e", gameState.carX + CAR_WIDTH/2, PLAYER_Y - 20); 
                            if (balance <= 0) { balance = 0; updateUI(); gameOver(); return; } 
                            getDrivingAdvice(getT("msgFine")); 
                        } else if (trafficLight.state === 'GREEN') { 
                            balance += 0.40; nitroTimer = 60; playSuccessSound(); playNitroSound();
                            spawnPopup("ğŸš€ + " + formatCurrency(0.40), "#10b981", gameState.carX + CAR_WIDTH/2, PLAYER_Y - 20); 
                        }
                        updateUI(); 
                    }
                    if (trafficLight.y > LOGICAL_HEIGHT) trafficLight.active = false;
                }

                // POLÄ°S
                if (!policeEvent.active && !trafficLight.active && Math.random() < 0.003 && score > 30) {
                    policeEvent.active = true; policeEvent.y = -200; policeEvent.passed = false; policeEvent.isWaiting = false; playPoliceSiren();
                }
                if (policeEvent.active) {
                    if (!policeEvent.isWaiting) policeEvent.y += baseSpeed;
                    if (policeEvent.y > PLAYER_Y - 50 && !policeEvent.passed) {
                        if (isBraking && !policeEvent.isWaiting) {
                            policeEvent.isWaiting = true; balance += 0.30; playSuccessSound();
                            spawnPopup("ğŸ‘® + " + formatCurrency(0.30), "#10b981", LOGICAL_WIDTH/2, PLAYER_Y - 30); updateUI();
                            getDrivingAdvice(getT("msgWait"));
                            setTimeout(() => { if (policeEvent.active) { policeEvent.isWaiting = false; policeEvent.passed = true; getDrivingAdvice(getT("msgGo")); playSuccessSound(); spawnPopup("âœ… " + getT("msgGo").toUpperCase(), "#34d399", LOGICAL_WIDTH/2, PLAYER_Y - 50); } }, 3000);
                        } else if (policeEvent.y > PLAYER_Y + CAR_HEIGHT && !policeEvent.isWaiting) {
                            policeEvent.passed = true; balance -= 0.60; playFineSound(); triggerScreenShake(); screenShake = 20;
                            spawnPopup("ğŸš“ - " + formatCurrency(0.60), "#f43f5e", LOGICAL_WIDTH/2, PLAYER_Y - 30);
                            if (balance <= 0) { balance = 0; updateUI(); gameOver(); return; } 
                            getDrivingAdvice(getT("msgStop")); updateUI();
                        }
                    }
                    if (policeEvent.y > LOGICAL_HEIGHT && policeEvent.passed) policeEvent.active = false;
                }

                // TRAFÄ°K
                if (Math.random() < 0.008 * speedMultiplier && !isBraking && !trafficLight.active && !policeEvent.active) {
                    const lane = LANES[Math.floor(Math.random() * LANES.length)];
                    if (trafficCars.every(c => Math.abs(c.x - (lane - CAR_WIDTH/2)) > 10 || c.y > 150)) {
                        trafficCars.push({ x: lane - CAR_WIDTH / 2, y: -150, speed: Math.random() * 0.5 + 1.0, color: TRAFFIC_COLORS[Math.floor(Math.random() * TRAFFIC_COLORS.length)], type: Math.random() > 0.8 ? 'truck' : 'car', height: Math.random() > 0.8 ? 130 : CAR_HEIGHT, nearMissed: false, crashed: false });
                    }
                }

                for (let i = trafficCars.length - 1; i >= 0; i--) {
                    let car = trafficCars[i]; car.y += baseSpeed + (isBraking ? car.speed * 2 : car.speed - 2); 
                    if (!car.crashed && gameState.carX < car.x + CAR_WIDTH - 12 && gameState.carX + CAR_WIDTH - 12 > car.x && PLAYER_Y < car.y + car.height - 12 && PLAYER_Y + CAR_HEIGHT - 12 > car.y) {
                        balance -= 0.10; playCrashSound(); triggerScreenShake(); screenShake = 20;
                        spawnPopup("- " + formatCurrency(0.10), "#f43f5e", gameState.carX + CAR_WIDTH/2, PLAYER_Y); 
                        car.crashed = true; trafficCars.splice(i, 1); 
                        if (balance <= 0) { balance = 0; updateUI(); gameOver(); return; } 
                        getDrivingAdvice(getT("msgCrash")); updateUI(); 
                    } 
                    else if (!car.crashed && !car.nearMissed && car.y > PLAYER_Y - car.height && car.y < PLAYER_Y + CAR_HEIGHT) {
                        if (Math.abs((gameState.carX + CAR_WIDTH/2) - (car.x + CAR_WIDTH/2)) < CAR_WIDTH + 20) {
                            car.nearMissed = true; balance += 0.05; playTone(800, 'sine', 0.1, 0.1); 
                            spawnPopup("âš¡ " + getT("msgDanger") + " + " + formatCurrency(0.05), "#facc15", gameState.carX + CAR_WIDTH/2, PLAYER_Y - 20); updateUI();
                        }
                    }
                    else if (car.y > LOGICAL_HEIGHT) { trafficCars.splice(i, 1); }
                }

                animatedPopups.forEach(p => { p.y -= (nitroTimer > 0 ? 3 : 1.5); p.alpha -= 0.015; p.life--; }); animatedPopups = animatedPopups.filter(p => p.life > 0);
                if (engineGain && audioCtx) { 
                    let freq = (isBraking || policeEvent.isWaiting) ? 30 : 40 * speedMultiplier;
                    if (nitroTimer > 0) freq = 80; 
                    engineOsc.frequency.setTargetAtTime(freq, audioCtx.currentTime, 0.1); 
                    engineGain.gain.setTargetAtTime((isBraking || policeEvent.isWaiting) ? 0.02 : Math.min(0.15, 0.08 * speedMultiplier), audioCtx.currentTime, 0.1); 
                }
            }

            function drawCar(x, y, color, isPlayer, braking, type = 'car', height = CAR_HEIGHT) {
                ctx.save(); ctx.shadowColor = 'rgba(0,0,0,0.5)'; ctx.shadowBlur = 15; ctx.shadowOffsetY = 10; ctx.fillStyle = color; 
                ctx.beginPath(); ctx.roundRect(x, y, CAR_WIDTH, height, 12); ctx.fill(); ctx.shadowColor = 'transparent'; 
                if (type === 'car' || type === 'police') {
                    ctx.fillStyle = '#020617'; ctx.beginPath(); ctx.roundRect(x + 4, y + 15, CAR_WIDTH - 8, 18, 4); ctx.fill(); 
                    ctx.beginPath(); ctx.roundRect(x + 6, y + height - 25, CAR_WIDTH - 12, 12, 3); ctx.fill();
                } else if (type === 'truck') {
                    ctx.fillStyle = '#0f172a'; ctx.beginPath(); ctx.roundRect(x + 2, y + 25, CAR_WIDTH - 4, height - 30, 4); ctx.fill();
                    ctx.fillStyle = '#020617'; ctx.beginPath(); ctx.roundRect(x + 4, y + 5, CAR_WIDTH - 8, 15, 4); ctx.fill();
                }
                if (isPlayer && (braking || policeEvent.isWaiting)) { ctx.fillStyle = '#f43f5e'; ctx.fillRect(x + 4, y + height - 6, 12, 4); ctx.fillRect(x + CAR_WIDTH - 16, y + height - 6, 12, 4); } 
                else if (!isPlayer) { ctx.fillStyle = '#fef08a'; ctx.beginPath(); ctx.arc(x + 10, y + 4, 3, 0, Math.PI*2); ctx.fill(); ctx.beginPath(); ctx.arc(x + CAR_WIDTH - 10, y + 4, 3, 0, Math.PI*2); ctx.fill(); }
                if (isPlayer && nitroTimer > 0) { ctx.fillStyle = 'rgba(34, 211, 238, 0.5)'; ctx.beginPath(); ctx.roundRect(x + 10, y + height, CAR_WIDTH - 20, Math.random() * 40 + 20, 5); ctx.fill(); }
                ctx.restore();
            }

            function draw() {
                if (!ctx) return; ctx.save();
                if (screenShake > 0) { ctx.translate(Math.random() * 10 - 5, Math.random() * 10 - 5); }
                const biome = BIOMES[0];
                ctx.fillStyle = biome.ground; ctx.fillRect(0, 0, LOGICAL_WIDTH, LOGICAL_HEIGHT); 
                ctx.fillStyle = biome.curb; ctx.fillRect(50, 0, 10, LOGICAL_HEIGHT); ctx.fillRect(LOGICAL_WIDTH - 60, 0, 10, LOGICAL_HEIGHT); 
                ctx.fillStyle = biome.road; ctx.fillRect(60, 0, LOGICAL_WIDTH - 120, LOGICAL_HEIGHT);
                let dashLength = nitroTimer > 0 ? 60 : 30; ctx.setLineDash([dashLength, 40]); ctx.strokeStyle = nitroTimer > 0 ? 'rgba(34, 211, 238, 0.4)' : 'rgba(255,255,255,0.15)'; ctx.lineWidth = 4; ctx.lineDashOffset = -gameState.linesOffset; ctx.beginPath(); ctx.moveTo(150, 0); ctx.lineTo(150, LOGICAL_HEIGHT); ctx.moveTo(250, 0); ctx.lineTo(250, LOGICAL_HEIGHT); ctx.stroke();

                if (trafficLight.active) {
                    ctx.fillStyle = 'rgba(255,255,255,0.8)'; ctx.fillRect(60, trafficLight.y, LOGICAL_WIDTH - 120, 8); ctx.fillStyle = '#0f172a'; ctx.beginPath(); ctx.roundRect(LOGICAL_WIDTH - 45, trafficLight.y - 70, 26, 75, 8); ctx.fill();
                    const drawLight = (yOff, color, active) => { ctx.save(); ctx.fillStyle = active ? color : '#1e293b'; ctx.beginPath(); ctx.arc(LOGICAL_WIDTH - 32, trafficLight.y - 70 + yOff, 8, 0, Math.PI*2); ctx.fill(); ctx.restore(); };
                    drawLight(16, '#f43f5e', trafficLight.state === 'RED'); drawLight(38, '#facc15', trafficLight.state === 'YELLOW'); drawLight(60, '#10b981', trafficLight.state === 'GREEN');
                }

                if (policeEvent.active) {
                    let px = LOGICAL_WIDTH - 55; drawCar(px, policeEvent.y, '#ffffff', false, false, 'police', CAR_HEIGHT);
                    ctx.fillStyle = (Date.now() % 400 < 200) ? '#f43f5e' : '#3b82f6'; ctx.fillRect(px + 10, policeEvent.y + 20, CAR_WIDTH - 20, 6);
                    ctx.fillStyle = '#f43f5e'; ctx.font = '900 20px sans-serif'; ctx.textAlign = 'right'; ctx.fillText("ğŸ›‘", px - 10, policeEvent.y + CAR_HEIGHT / 2);
                }

                trafficCars.forEach(car => drawCar(car.x, car.y, car.color, false, false, car.type, car.height));
                drawCar(gameState.carX, PLAYER_Y, CAR_SKINS.find(c => c.id === activeSkinId).color, true, isBraking, 'car', CAR_HEIGHT); 
                animatedPopups.forEach(p => { ctx.save(); ctx.fillStyle = p.color; ctx.globalAlpha = Math.max(0, p.alpha); ctx.font = '900 20px sans-serif'; ctx.textAlign = 'center'; ctx.fillText(p.text, p.x, p.y); ctx.restore(); });
                if (nitroTimer > 0) { ctx.fillStyle = 'rgba(34, 211, 238, ' + (nitroTimer/60 * 0.1) + ')'; ctx.fillRect(0, 0, LOGICAL_WIDTH, LOGICAL_HEIGHT); }
                ctx.restore();
            }

            function gameLoop() { update(); draw(); if (isGameRunning && ctx) requestAnimationFrame(gameLoop); }

            addEvt('loginBtn', 'click', startGame); 
            addEvt('restartBtn', 'click', startGame);
            addEvt('gameOverTopupBtn', 'click', () => { document.getElementById('topUpModal').classList.remove('hidden'); });
            addEvt('buyMeCoffeeBtn', 'click', () => { window.open('https://buymeacoffee.com/surwin', '_blank'); });
            
            addEvt('verifyPaymentBtn', 'click', (e) => {
                const btn = e.currentTarget; const originalText = btn.innerHTML; btn.innerHTML = `â³ ...`; btn.disabled = true;
                setTimeout(() => {
                    let user = null;
                    try { user = JSON.parse(localStorage.getItem('premiumDriveUser')); } catch(e){}
                    
                    if (user && !user.bonusClaimed) { 
                        balance += 0.50; user.bonusClaimed = true; 
                        try { localStorage.setItem('premiumDriveUser', JSON.stringify(user)); } catch(e){} 
                        updateUI(); playSuccessSound(); btn.innerHTML = `âœ… (+ ${formatCurrency(0.50)})`; 
                    } 
                    else { balance += 3.40; updateUI(); playSuccessSound(); btn.innerHTML = `âœ… (+ ${formatCurrency(3.40)})`; }
                    btn.classList.replace('text-emerald-400', 'text-white'); btn.classList.replace('bg-emerald-500/10', 'bg-emerald-600');
                    
                    setTimeout(() => { 
                        document.getElementById('topUpModal').classList.add('hidden'); 
                        btn.innerHTML = originalText; btn.disabled = false; btn.classList.replace('text-white', 'text-emerald-400'); btn.classList.replace('bg-emerald-600', 'bg-emerald-500/10'); 
                        if (isGameOver && balance > 0) {
                            const title = document.getElementById('gameOverTitle'); const restartBtn = document.getElementById('restartBtn'); const topupBtn = document.getElementById('gameOverTopupBtn'); const msg = document.getElementById('gameOverMessage');
                            if(title) { title.innerText = "GAME OVER"; title.classList.replace('text-red-600', 'text-rose-500'); }
                            if(restartBtn) restartBtn.classList.remove('hidden'); 
                            if(topupBtn) topupBtn.classList.add('hidden'); 
                            if(msg) msg.classList.add('hidden'); 
                            getDrivingAdvice(getT("msgPaySuccess"));
                        }
                    }, 2000);
                }, 3000);
            });

            const toggleModal = (btnId, modalId, show) => {
                addEvt(btnId, 'click', () => { 
                    const modEl = document.getElementById(modalId);
                    if(modEl) modEl.classList[show ? 'remove' : 'add']('hidden'); 
                    updateUI(); 
                    if(show && modalId==='garageModal') renderGarage(); 
                });
            };
            toggleModal('loginTopupBtn', 'topUpModal', true); toggleModal('topupBtn', 'topUpModal', true); toggleModal('closeTopUpBtn', 'topUpModal', false);
            toggleModal('withdrawBtn', 'withdrawModal', true); toggleModal('closeWithdrawBtn', 'withdrawModal', false);
            toggleModal('garageBtn', 'garageModal', true); toggleModal('closeGarageBtn', 'garageModal', false);

            const startBraking = (e) => { e.preventDefault(); isBraking = true; }; 
            const stopBraking = (e) => { e.preventDefault(); isBraking = false; };
            
            const brakeBtn = document.getElementById('brakeBtn');
            if(brakeBtn) {
                brakeBtn.addEventListener('mousedown', startBraking); brakeBtn.addEventListener('mouseup', stopBraking); 
                brakeBtn.addEventListener('touchstart', startBraking, {passive: false}); brakeBtn.addEventListener('touchend', stopBraking, {passive: false});
            }
            
            const goLeft = (e) => { e.preventDefault(); if(gameState.targetX > LANES[0] - CAR_WIDTH/2) gameState.targetX -= 100; }; 
            const goRight = (e) => { e.preventDefault(); if(gameState.targetX < LANES[2] - CAR_WIDTH/2) gameState.targetX += 100; };
            
            const lLeft = document.getElementById('laneLeft');
            if(lLeft) { lLeft.addEventListener('mousedown', goLeft); lLeft.addEventListener('touchstart', goLeft, {passive: false}); }
            
            const lRight = document.getElementById('laneRight');
            if(lRight) { lRight.addEventListener('mousedown', goRight); lRight.addEventListener('touchstart', goRight, {passive: false}); }

        }); // DOMContentLoaded BITÄ°ÅÄ°
    </script>
</body>
</html>
