<!DOCTYPE html>
<html lang="az" id="htmlTag">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Premium Drive - AI Audio Edition</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    
    <script type="importmap">
      {
        "imports": {
          "@google/generative-ai": "https://esm.run/@google/generative-ai"
        }
      }
    </script>

    <style>
        body { user-select: none; -webkit-user-select: none; touch-action: none; overflow: hidden; }
        .hidden { display: none !important; }
        .rtl { direction: rtl; font-family: 'Arial', sans-serif; }
    </style>
</head>
<body class="bg-slate-950 text-white h-screen flex flex-col font-sans relative transition-all duration-300">

    <div id="loginScreen" class="h-screen flex items-center justify-center p-6 z-40 absolute inset-0 bg-slate-950">
        <div class="bg-slate-900 p-10 rounded-[32px] border border-white/5 w-full max-w-sm text-center shadow-2xl">
            <h1 class="text-3xl font-black text-white italic mb-2 tracking-tighter">PREMIUM DRIVE</h1>
            <p class="text-slate-400 text-sm mb-8"><span id="lbl_loginBalance">Balans:</span> <span id="loginBalanceText" class="font-bold text-cyan-400">0.00 AZN</span></p>
            <button id="loginBtn" class="w-full py-4 bg-cyan-600 rounded-2xl text-white font-bold uppercase tracking-widest shadow-lg shadow-cyan-600/20 active:translate-y-1 transition-all">
                Oyuna Ba≈üla
            </button>
            <button id="loginTopupBtn" class="w-full mt-4 py-4 bg-slate-800 rounded-2xl text-white font-bold uppercase tracking-widest active:translate-y-1 transition-all">
                Balansƒ± Artƒ±r
            </button>
        </div>
    </div>

    <div id="gameScreen" class="hidden h-screen flex flex-col relative">
        <div class="p-4 flex justify-between items-center z-30">
            <div class="flex gap-2">
                <div class="bg-slate-900/80 backdrop-blur-xl p-3 px-4 rounded-2xl border border-white/10 shadow-2xl transition-all" id="balanceBox">
                    <p id="lbl_hudBalance" class="text-[10px] font-black text-cyan-400 uppercase tracking-[2px] mb-0.5">Balans</p>
                    <p id="balanceText" class="text-lg font-black">0.00 AZN</p>
                </div>
                <div class="bg-slate-900/80 backdrop-blur-xl p-3 px-4 rounded-2xl border border-white/10 shadow-2xl">
                    <p id="lbl_hudDistance" class="text-[10px] font-black text-rose-400 uppercase tracking-[2px] mb-0.5">M…ôsaf…ô</p>
                    <p id="scoreText" class="text-lg font-black">0 M</p>
                </div>
            </div>
            <div class="flex gap-2">
                <button id="langBtn" class="w-12 h-12 bg-blue-600/20 border border-blue-500/50 rounded-xl flex items-center justify-center text-xl active:bg-blue-600/40 transition-all">üá¶üáø</button>
                <button id="topupBtn" class="w-12 h-12 bg-emerald-600/20 border border-emerald-500/50 rounded-xl flex items-center justify-center text-xl active:bg-emerald-600/40">üí≥</button>
            </div>
        </div>

        <div class="px-4 z-30">
            <div class="bg-blue-900/40 border border-blue-500/30 rounded-xl p-3 text-sm text-blue-200 text-center italic shadow-lg">
                <span id="aiIcon">üí°</span> AI: <span id="aiTipText">S√ºni intellekt m…ôsl…ôh…ôti y√ºkl…ônir...</span>
            </div>
        </div>

        <div class="flex-1 flex items-center justify-center p-4 relative">
            <div class="relative w-full h-full max-w-[400px] max-h-[600px] bg-slate-900 rounded-[40px] overflow-hidden border-4 border-slate-800 shadow-2xl">
                <canvas id="gameCanvas" width="400" height="600" class="w-full h-full object-contain"></canvas>
                <div class="absolute inset-0 flex">
                    <div id="laneLeft" class="flex-1 active:bg-white/5 cursor-pointer"></div>
                    <div id="laneRight" class="flex-1 active:bg-white/5 cursor-pointer"></div>
                </div>
                <div id="gameOverScreen" class="hidden absolute inset-0 bg-slate-950/90 backdrop-blur-md flex-col items-center justify-center p-10 text-center z-40">
                    <h2 id="gameOverTitle" class="text-4xl font-black text-rose-500 mb-2 italic">Q∆èZA!</h2>
                    <p class="text-slate-400 text-sm mb-4"><span id="lbl_gameOverDistance">Toplanan M…ôsaf…ô:</span> <span id="finalScore" class="font-bold text-white">0</span> M</p>
                    <button id="restartBtn" class="w-full py-4 bg-cyan-600 rounded-2xl font-black mb-3 active:translate-y-1 transition-all">YENƒ∞D∆èN BA≈ûLA</button>
                    <button id="gameOverTopupBtn" class="w-full py-4 bg-emerald-600 rounded-2xl font-black active:translate-y-1 transition-all">BALANSI ARTIR</button>
                </div>
            </div>
        </div>

        <div class="p-6 pb-10 max-w-lg mx-auto w-full z-30">
            <button id="brakeBtn" class="w-full py-6 rounded-[28px] text-2xl font-black transition-all border-b-[6px] bg-rose-600 border-rose-800 shadow-lg active:translate-y-1 active:border-b-0 active:bg-rose-700 active:border-rose-900">
                TORMOZ
            </button>
        </div>
    </div>

    <div id="topUpModal" class="hidden absolute inset-0 bg-slate-950/90 backdrop-blur-md flex items-center justify-center p-6 z-[100]">
        <div class="bg-slate-900 p-8 rounded-[32px] border border-white/10 text-center w-full max-w-sm shadow-2xl">
            <h2 id="lbl_topupModalTitle" class="text-2xl font-black mb-4 italic uppercase">Balansƒ±n Artƒ±r</h2>
            <button id="demoTopUpBtn" class="w-full py-4 bg-emerald-600 rounded-2xl font-black text-white mb-6 active:translate-y-1 transition-all">
                +10 AZN (Demo Test)
            </button>
            <button id="closeTopUpBtn" class="text-slate-500 text-[12px] font-bold uppercase tracking-widest active:text-white transition-all">Baƒüla</button>
        </div>
    </div>
    <div id="langModal" class="hidden absolute inset-0 bg-slate-950/90 backdrop-blur-md flex items-center justify-center p-6 z-[100]">
        <div class="bg-slate-900 p-6 rounded-[32px] border border-white/10 text-center w-full max-w-sm shadow-2xl">
            <h2 class="text-xl font-black mb-6 italic text-white">Dil / Language</h2>
            <div id="langList" class="grid grid-cols-2 gap-3 mb-6"></div>
            <button id="closeLangBtn" class="text-slate-500 text-[12px] font-bold uppercase tracking-widest active:text-white transition-all">Geri</button>
        </div>
    </div>

    <script type="module">
        import { GoogleGenerativeAI } from "@google/generative-ai";

        // ==========================================
        // Dƒ∞LL∆èR, T∆èRC√úM∆è V∆è TTS KODLARI
        // ==========================================
        const LANGUAGES = {
            az: { name: 'Az…ôrbaycan', flag: 'üá¶üáø', currency: 'AZN', rate: 1, dir: 'ltr', tts: 'tr-TR' }, // WebSpeech-d…ô AZ yoxdursa, T√ºrkc…ô oxuyur
            en: { name: 'English', flag: 'üá¨üáß', currency: 'USD', rate: 0.59, dir: 'ltr', tts: 'en-US' },
            ru: { name: '–†—É—Å—Å–∫–∏–π', flag: 'üá∑üá∫', currency: 'RUB', rate: 54.4, dir: 'ltr', tts: 'ru-RU' },
            tr: { name: 'T√ºrk√ße', flag: 'üáπüá∑', currency: 'TRY', rate: 20.3, dir: 'ltr', tts: 'tr-TR' }
        };

        const TRANSLATIONS = {
            az: { loginBtn: "Oyuna Ba≈üla", hudBal: "Balans", brake: "TORMOZ", braking: "DAYANIR...", crash: "Q∆èZA!", fuel: "BENZƒ∞N Bƒ∞TDƒ∞", aiThinking: "AI d√º≈ü√ºn√ºr... ü§ñ" },
            en: { loginBtn: "Start Game", hudBal: "Balance", brake: "BRAKE", braking: "BRAKING...", crash: "CRASH!", fuel: "OUT OF GAS", aiThinking: "AI is thinking... ü§ñ" },
            ru: { loginBtn: "–ù–∞—á–∞—Ç—å", hudBal: "–ë–∞–ª–∞–Ω—Å", brake: "–¢–û–†–ú–û–ó", braking: "–¢–û–†–ú–û–ñ–ï–ù–ò–ï...", crash: "–ê–í–ê–†–ò–Ø!", fuel: "–ù–ï–¢ –ë–ï–ù–ó–ò–ù–ê", aiThinking: "–ò–ò –¥—É–º–∞–µ—Ç... ü§ñ" },
            tr: { loginBtn: "Ba≈üla", hudBal: "Bakiye", brake: "FREN", braking: "DURUYOR...", crash: "KAZA!", fuel: "BENZƒ∞N Bƒ∞TTƒ∞", aiThinking: "YZ d√º≈ü√ºn√ºyor... ü§ñ" }
        };

        let currentLang = 'az';
        let isSpeaking = false;

        function applyLanguage(code) {
            currentLang = code;
            document.getElementById('langBtn').innerText = LANGUAGES[code].flag;
            document.getElementById('loginBtn').innerText = TRANSLATIONS[code].loginBtn;
            document.getElementById('lbl_hudBalance').innerText = TRANSLATIONS[code].hudBal;
            document.getElementById('brakeBtn').innerText = isBraking ? TRANSLATIONS[code].braking : TRANSLATIONS[code].brake;
            updateUI(); 
            document.getElementById('langModal').classList.add('hidden');
        }

        // ==========================================
        // AUDIO Sƒ∞STEMƒ∞ (WEB AUDIO API & TTS)
        // ==========================================
        let audioCtx = null; 
        let engineOsc = null; 
        let engineGain = null;

        function initAudio() {
            if (audioCtx) return;
            audioCtx = new (window.AudioContext || window.webkitAudioContext)();
            engineOsc = audioCtx.createOscillator(); 
            engineGain = audioCtx.createGain();
            engineOsc.type = 'sawtooth'; 
            engineOsc.frequency.setValueAtTime(40, audioCtx.currentTime);
            engineGain.gain.setValueAtTime(0.08, audioCtx.currentTime); 
            engineOsc.connect(engineGain); 
            engineGain.connect(audioCtx.destination); 
            engineOsc.start();
        }

        function playTone(freq, type, duration, vol = 0.1) {
            if (!audioCtx) return;
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            osc.type = type;
            osc.frequency.setValueAtTime(freq, audioCtx.currentTime);
            gain.gain.setValueAtTime(vol, audioCtx.currentTime);
            gain.gain.exponentialRampToValueAtTime(0.001, audioCtx.currentTime + duration);
            osc.connect(gain);
            gain.connect(audioCtx.destination);
            osc.start();
            osc.stop(audioCtx.currentTime + duration);
        }

        // Q…ôza S…ôsi (Crash)
        function playCrashSound() { 
            playTone(150, 'sawtooth', 0.5, 0.3); 
            setTimeout(() => playTone(50, 'square', 0.8, 0.4), 100);
        }

        // Uƒüur/Artƒ±m S…ôsi (Success)
        function playSuccessSound() { 
            playTone(440, 'sine', 0.1); 
            setTimeout(() => playTone(660, 'sine', 0.3), 100); 
        }

        // C…ôrim…ô S…ôsi (Fine)
        function playFineSound() { 
            playTone(200, 'square', 0.2); 
            setTimeout(() => playTone(150, 'square', 0.3), 150);
            
            // Ekranda vizual effekt
            const box = document.getElementById('balanceBox');
            box.classList.add('border-rose-500', 'bg-rose-900/50');
            setTimeout(() => box.classList.remove('border-rose-500', 'bg-rose-900/50'), 500);
        }

        // AI S…ôsli Oxuma (TTS)
        function getSpeechData(text) {
            if ('speechSynthesis' in window) {
                window.speechSynthesis.cancel(); // ∆èvv…ôlki s…ôsi k…ôs
                const utterance = new SpeechSynthesisUtterance(text);
                utterance.lang = LANGUAGES[currentLang].tts;
                utterance.rate = 1.1; // S√ºr…ôt
                utterance.pitch = 1.0; 
                
                utterance.onstart = () => { document.getElementById("aiIcon").innerText = "üîä"; };
                utterance.onend = () => { document.getElementById("aiIcon").innerText = "üí°"; };
                
                window.speechSynthesis.speak(utterance);
            }
        }

        // ==========================================
        // S√úNƒ∞ ƒ∞NTELLEKT (GEMƒ∞Nƒ∞) V∆è MOTƒ∞VASƒ∞YA
        // ==========================================
        const API_KEY = "Sƒ∞Zƒ∞N_API_A√áARINIZI_BURAYA_YAPI≈ûDIRIN"; 
        const genAI = new GoogleGenerativeAI(API_KEY);

        async function getDrivingAdvice(scenario) {
            const aiTipEl = document.getElementById("aiTipText");
            aiTipEl.innerText = TRANSLATIONS[currentLang].aiThinking;
            try {
                const model = genAI.getGenerativeModel({ model: "gemini-1.5-flash" });
                const prompt = `S…ôn "Premium Drive" oyununda oyun√ßuya s…ôsli b…ôl…ôd√ßilik ed…ôn k√∂m…ôk√ßis…ôn. Ssenari: ${scenario}. Qƒ±sa, enerjili v…ô maksimum 1 c√ºml…ôlik cavab ver. M√ºtl…ôq bu dild…ô cavab ver: ${LANGUAGES[currentLang].name}.`;
                const result = await model.generateContent(prompt);
                const text = await result.response.text();
                aiTipEl.innerText = text;
                
                // M…ôtni oxutdur
                getSpeechData(text);
            } catch (error) {
                console.error(error);
                aiTipEl.innerText = "Yolda diqq…ôtli olun!";
            }
        }

        let motivationTimer = null;
        function startMotivationTimer() {
            clearInterval(motivationTimer);
            motivationTimer = setInterval(() => {
                if (isGameRunning && !isGameOver && !isBraking) {
                    getDrivingAdvice("Oyun√ßu yax≈üƒ± ir…ôlil…ôyir. Ona qƒ±sa motivasiya ver.");
                }
            }, 30000); // H…ôr 30 saniy…ôd…ôn bir
        }

        // ==========================================
        // OYUN M∆èNTƒ∞Qƒ∞ (Qƒ±saldƒ±lmƒ±≈ü)
        // ==========================================
        const LOGICAL_WIDTH = 400; const LOGICAL_HEIGHT = 600;
        const CAR_WIDTH = 48; const CAR_HEIGHT = 86; const PLAYER_Y = LOGICAL_HEIGHT - 130;
        const LANES = [100, 200, 300]; 

        let isGameRunning = false; let isBraking = false; let isGameOver = false;
        let balance = 0.00; let score = 0; let trafficCars = []; let speedMultiplier = 1; 
        let gameState = { carX: LANES[1] - CAR_WIDTH / 2, targetX: LANES[1] - CAR_WIDTH / 2, linesOffset: 0 };
        const canvas = document.getElementById('gameCanvas'); const ctx = canvas.getContext('2d');

        function updateUI() {
            const info = LANGUAGES[currentLang];
            document.getElementById('balanceText').innerText = `${(balance * info.rate).toFixed(2)} ${info.currency}`;
            document.getElementById('loginBalanceText').innerText = `${(balance * info.rate).toFixed(2)} ${info.currency}`;
            document.getElementById('scoreText').innerText = `${Math.floor(score)} M`;
        }

        document.getElementById('demoTopUpBtn').addEventListener('click', () => {
            balance += 10.00; playSuccessSound(); updateUI(); document.getElementById('topUpModal').classList.add('hidden');
        });

        function startGame() {
            document.getElementById('loginScreen').classList.add('hidden');
            document.getElementById('gameScreen').classList.remove('hidden');
            document.getElementById('gameOverScreen').classList.add('hidden');
            
            initAudio(); isGameRunning = true; isGameOver = false;
            score = 0; speedMultiplier = 1; trafficCars = [];
            gameState.carX = LANES[1] - CAR_WIDTH / 2; gameState.targetX = LANES[1] - CAR_WIDTH / 2;
            
            updateUI(); 
            getDrivingAdvice("Oyun√ßu yeni oyuna ba≈ülayƒ±r, 'Uƒüurlar' de.");
            startMotivationTimer();
            requestAnimationFrame(gameLoop);
        }

        function gameOver(reason) {
            isGameOver = true;
            clearInterval(motivationTimer);
            document.getElementById('gameOverScreen').classList.remove('hidden');
            document.getElementById('finalScore').innerText = Math.floor(score);
            
            if (reason === 'crash') {
                playCrashSound();
                document.getElementById('gameOverTitle').innerText = TRANSLATIONS[currentLang].crash;
                getDrivingAdvice(`Oyun√ßu ba≈üqa ma≈üƒ±na √ßƒ±rpƒ±ldƒ±. Zarafatyana 'Diqq…ôtli ol' de.`);
            } else {
                document.getElementById('gameOverTitle').innerText = TRANSLATIONS[currentLang].fuel;
                getDrivingAdvice("Oyun√ßunun pulu/benzini bitdi.");
            }
            if (engineGain) engineGain.gain.setTargetAtTime(0, audioCtx.currentTime, 0.1);
        }

        function spawnTrafficCar() {
            const lane = LANES[Math.floor(Math.random() * LANES.length)];
            const isSafe = trafficCars.every(c => Math.abs(c.x - (lane - CAR_WIDTH/2)) > 10 || c.y > 150);
            if (isSafe) trafficCars.push({ x: lane - CAR_WIDTH / 2, y: -100, speed: Math.random() * 2 + 2, color: '#ef4444' });
        }

        function switchLane(direction) {
            if (isGameOver) return;
            let currentLaneIndex = LANES.indexOf(LANES.find(l => Math.abs(l - CAR_WIDTH/2 - gameState.targetX) < 10) || LANES[1]);
            if (direction === 'L' && currentLaneIndex > 0) currentLaneIndex--;
            if (direction === 'R' && currentLaneIndex < 2) currentLaneIndex++;
            gameState.targetX = LANES[currentLaneIndex] - CAR_WIDTH / 2;
        }

        function update() {
            if (!isGameRunning || isGameOver) return;
            const baseSpeed = isBraking ? 1 : 6 * speedMultiplier;
            
            if (!isBraking) {
                score += 0.1 * speedMultiplier; speedMultiplier += 0.0001; balance -= 0.005; 
                
                // T…ôsad√ºfi "Radar/C…ôrim…ô" Mexanikasƒ± (1% ehtimal)
                if(Math.random() < 0.001 * speedMultiplier) {
                    balance -= 0.5; // C…ôrim…ô √ßƒ±xƒ±lƒ±r
                    playFineSound();
                    getDrivingAdvice("S√ºr…ôt h…ôddini a≈üdƒ±ƒüƒ±na g√∂r…ô radar c…ôrim…ôsi yazƒ±ldƒ±.");
                }

                updateUI(); if (balance <= 0) { balance = 0; gameOver('balance'); }
            }

            gameState.linesOffset = (gameState.linesOffset + baseSpeed) % 80;
            gameState.carX += (gameState.targetX - gameState.carX) * 0.15;
            if (Math.random() < 0.02 * speedMultiplier && !isBraking) spawnTrafficCar();

            for (let i = trafficCars.length - 1; i >= 0; i--) {
                let car = trafficCars[i];
                car.y += baseSpeed + (isBraking ? car.speed * 2 : car.speed - 2); 
                if (gameState.carX < car.x + CAR_WIDTH - 5 && gameState.carX + CAR_WIDTH - 5 > car.x && PLAYER_Y < car.y + CAR_HEIGHT - 5 && PLAYER_Y + CAR_HEIGHT - 5 > car.y) gameOver('crash');
                if (car.y > LOGICAL_HEIGHT) trafficCars.splice(i, 1);
            }
            if (engineGain && audioCtx) {
                engineOsc.frequency.setTargetAtTime(40 * speedMultiplier, audioCtx.currentTime, 0.1);
                engineGain.gain.setTargetAtTime(isBraking ? 0.02 : Math.min(0.15, 0.08 * speedMultiplier), audioCtx.currentTime, 0.1);
            }
        }

        function draw() {
            if (!ctx) return;
            ctx.fillStyle = '#0f172a'; ctx.fillRect(0, 0, LOGICAL_WIDTH, LOGICAL_HEIGHT);
            ctx.fillStyle = '#1e293b'; ctx.fillRect(60, 0, LOGICAL_WIDTH - 120, LOGICAL_HEIGHT);
            ctx.setLineDash([30, 50]); ctx.strokeStyle = 'rgba(255,255,255,0.2)'; ctx.lineWidth = 4; ctx.lineDashOffset = -gameState.linesOffset;
            ctx.beginPath(); ctx.moveTo(150, 0); ctx.lineTo(150, LOGICAL_HEIGHT); ctx.moveTo(250, 0); ctx.lineTo(250, LOGICAL_HEIGHT); ctx.stroke();

            trafficCars.forEach(car => { ctx.fillStyle = car.color; ctx.beginPath(); ctx.roundRect(car.x, car.y, CAR_WIDTH, CAR_HEIGHT, 8); ctx.fill(); });
            ctx.fillStyle = '#3b82f6'; ctx.beginPath(); ctx.roundRect(gameState.carX, PLAYER_Y, CAR_WIDTH, CAR_HEIGHT, 10); ctx.fill(); 

            if (isBraking) { ctx.fillStyle = '#ff0000'; ctx.fillRect(gameState.carX + 5, PLAYER_Y + CAR_HEIGHT - 5, 8, 4); ctx.fillRect(gameState.carX + CAR_WIDTH - 13, PLAYER_Y + CAR_HEIGHT - 5, 8, 4); }
        }

        function gameLoop() { update(); draw(); if (isGameRunning) requestAnimationFrame(gameLoop); }

        // Event Listeners
        document.getElementById('loginBtn').addEventListener('click', () => { if(balance<=0) document.getElementById('topUpModal').classList.remove('hidden'); else startGame(); });
        document.getElementById('restartBtn').addEventListener('click', () => { if(balance<=0) document.getElementById('topUpModal').classList.remove('hidden'); else startGame(); });
        
        // Modal Openers
        document.getElementById('loginTopupBtn').addEventListener('click', () => document.getElementById('topUpModal').classList.remove('hidden'));
        document.getElementById('topupBtn').addEventListener('click', () => document.getElementById('topUpModal').classList.remove('hidden'));
        document.getElementById('gameOverTopupBtn').addEventListener('click', () => document.getElementById('topUpModal').classList.remove('hidden'));
        document.getElementById('langBtn').addEventListener('click', () => document.getElementById('langModal').classList.remove('hidden'));
        document.getElementById('closeLangBtn').addEventListener('click', () => document.getElementById('langModal').classList.add('hidden'));

        // Dil Se√ßimi Generasiyasƒ±
        const langList = document.getElementById('langList');
        Object.keys(LANGUAGES).forEach(code => {
            const btn = document.createElement('button');
            btn.className = "py-3 bg-slate-800 rounded-xl font-bold flex items-center justify-center gap-2 active:bg-slate-700 text-sm";
            btn.innerHTML = `<span>${LANGUAGES[code].flag}</span> <span>${LANGUAGES[code].name}</span>`;
            btn.onclick = () => applyLanguage(code);
            langList.appendChild(btn);
        });

        // Kontrollar
        const brakeBtn = document.getElementById('brakeBtn');
        const startBraking = (e) => { e.preventDefault(); isBraking = true; brakeBtn.innerText = TRANSLATIONS[currentLang].braking; };
        const stopBraking = (e) => { e.preventDefault(); isBraking = false; brakeBtn.innerText = TRANSLATIONS[currentLang].brake; };
        brakeBtn.addEventListener('mousedown', startBraking); brakeBtn.addEventListener('mouseup', stopBraking);
        brakeBtn.addEventListener('touchstart', startBraking, {passive: false}); brakeBtn.addEventListener('touchend', stopBraking, {passive: false});
        document.getElementById('laneLeft').addEventListener('mousedown', () => switchLane('L')); document.getElementById('laneLeft').addEventListener('touchstart', (e) => { e.preventDefault(); switchLane('L'); }, {passive: false});
        document.getElementById('laneRight').addEventListener('mousedown', () => switchLane('R')); document.getElementById('laneRight').addEventListener('touchstart', (e) => { e.preventDefault(); switchLane('R'); }, {passive: false});

        applyLanguage(currentLang);
    </script>
</body>
</html>
