<!DOCTYPE html>
<html lang="az">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SÃ¼rÃ¼cÃ¼lÃ¼k AkademiyasÄ± - VIP</title>
    <style>
        body { background-color: #0f0f1e; color: #ffffff; font-family: 'Segoe UI', sans-serif; margin: 0; padding: 0; display: flex; flex-direction: column; align-items: center; min-height: 100vh; overflow-x: hidden; }
        
        /* GÄ°RÄ°Å EKRANI */
        #auth-screen { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #0f0f1e; display: flex; justify-content: center; align-items: center; z-index: 2000; }
        .auth-container { background: rgba(255, 255, 255, 0.05); padding: 30px; border-radius: 20px; border: 1px solid #00ff88; width: 320px; text-align: center; box-shadow: 0 0 20px #00ff8833; }
        .auth-input { width: 100%; padding: 12px; margin-bottom: 12px; border-radius: 8px; border: 1px solid #333; background: #000; color: white; box-sizing: border-box; }
        .auth-btn { width: 100%; padding: 12px; background: #00ff88; color: #000; border: none; border-radius: 8px; font-weight: bold; cursor: pointer; }

        /* OYUN ÃœST PANEL */
        #game-interface { display: none; flex-direction: column; align-items: center; width: 100%; padding-top: 10px; }
        .top-bar { width: 480px; display: flex; justify-content: space-between; align-items: center; background: rgba(0,0,0,0.85); padding: 12px; border-radius: 12px; border: 1px solid #00ff88; margin-bottom: 10px; box-shadow: 0 4px 15px rgba(0,0,0,0.5); }
        .balance-box { text-align: left; }
        .balance-amount { color: #00ff88; font-size: 22px; font-weight: bold; display: block; }
        
        .nav-btns button { background: #1a1a2e; color: #fff; border: 1px solid #00ff88; padding: 6px 10px; border-radius: 6px; cursor: pointer; font-size: 12px; transition: 0.3s; }
        .nav-btns button:hover { background: #00ff88; color: #000; }

        /* OYUN SAHÆSÄ° */
        canvas { background-color: #2ecc71; border: 4px solid #111; border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.7); }
        .controls { margin-top: 15px; }
        .brake-btn { background: linear-gradient(to bottom, #ff416c, #ff4b2b); color: white; padding: 18px 60px; border-radius: 50px; border: 3px solid white; font-weight: bold; cursor: pointer; font-size: 20px; box-shadow: 0 5px 15px rgba(255,0,0,0.4); }

        /* MODAL (PÆNCÆRÆ) DÄ°ZAYNLARI */
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); z-index: 3000; justify-content: center; align-items: center; padding: 20px; box-sizing: border-box; }
        .modal-content { background: #1a1a2e; border: 2px solid #00ff88; padding: 25px; border-radius: 20px; width: 100%; max-width: 400px; max-height: 80vh; overflow-y: auto; position: relative; }
        .close-x { position: absolute; top: 10px; right: 15px; font-size: 25px; cursor: pointer; color: #ff4d4d; }

        /* QARAJDA MAÅINLARIN GÃ–RÃœNÃœÅÃœ */
        .garage-item { background: #0f0f1e; border: 1px solid #333; border-radius: 12px; padding: 15px; margin-bottom: 15px; display: flex; align-items: center; justify-content: space-between; }
        .car-preview { width: 60px; height: 100px; border-radius: 5px; position: relative; border: 1px solid #555; }
        .car-buy-btn { background: #00ff88; color: #000; border: none; padding: 10px 15px; border-radius: 5px; font-weight: bold; cursor: pointer; }

        /* BAKÄ°YÆ YÃœKLÆMÆ */
        .deposit-input { width: 100%; padding: 12px; margin: 10px 0; border-radius: 8px; border: 1px solid #00ff88; background: #000; color: white; font-size: 18px; text-align: center; }

        /* Ã‡AT WÄ°DGET */
        .chat-btn { position: fixed; bottom: 20px; right: 20px; width: 55px; height: 55px; background: #00ff88; border-radius: 50%; display: flex; justify-content: center; align-items: center; font-size: 25px; cursor: pointer; z-index: 100; border: none; }
        #chat-box { display: none; position: fixed; bottom: 85px; right: 20px; width: 280px; height: 350px; background: #1a1a2e; border: 1px solid #00ff88; border-radius: 15px; flex-direction: column; z-index: 100; }
    </style>
</head>
<body>

    <div id="auth-screen">
        <div class="auth-container">
            <h2 id="auth-title" style="color:#00ff88; margin-top:0;">XOÅ GÆLDÄ°NÄ°Z</h2>
            <input type="text" id="username" class="auth-input" placeholder="Ä°stifadÉ™Ã§i adÄ±">
            <input type="password" id="password" class="auth-input" placeholder="ÅifrÉ™">
            <button class="auth-btn" onclick="handleAuth()">DAXÄ°L OL / QEYDÄ°YYAT</button>
            <p style="font-size:11px; color:#888; margin-top:15px;">MÉ™lumatlar brauzer yaddaÅŸÄ±nda saxlanÄ±lÄ±r.</p>
        </div>
    </div>

    <div id="game-interface">
        <div class="top-bar">
            <div class="balance-box">
                <span style="font-size:12px; color:#aaa;">Cari BakiyÉ™:</span>
                <span class="balance-amount"><span id="balance">100.00</span> â‚¼</span>
            </div>
            <div class="nav-btns">
                <button onclick="openModal('garageModal')">ğŸ›’ Qaraj</button>
                <button onclick="openModal('depositModal')">ğŸ’° BakiyÉ™</button>
                <button onclick="openModal('infoModal')">â„¹ï¸ HaqqÄ±nda</button>
            </div>
        </div>

        <canvas id="gameCanvas" width="450" height="480"></canvas>
        
        <div id="game-msg" style="position:absolute; top:45%; font-size:28px; font-weight:bold; opacity:0; transition:0.3s; z-index:50;"></div>
        
        <div class="controls">
            <button class="brake-btn" id="brakeBtn">TORMOZ VER!</button>
        </div>
    </div>

    <div id="infoModal" class="modal">
        <div class="modal-content">
            <span class="close-x" onclick="closeModal('infoModal')">&times;</span>
            <h2 style="color:#00ff88;">ğŸ“– Oyun HaqqÄ±nda</h2>
            <p><b>Oyunun ÅÉ™rtlÉ™ri:</b> MaÅŸÄ±n avtomatik irÉ™lilÉ™yir. MÉ™qsÉ™diniz iÅŸÄ±qfora tabe olmaqdÄ±r.</p>
            <p>ğŸ”´ <b>QÄ±rmÄ±zÄ± Ä°ÅŸÄ±q:</b> MÃ¼tlÉ™q "Tormoz" dÃ¼ymÉ™sini basÄ±b saxlayaraq dayanmalÄ±sÄ±nÄ±z. Æks halda <b>-0.20 â‚¼</b> cÉ™rimÉ™ olunacaqsÄ±nÄ±z.</p>
            <p>ğŸŸ¢ <b>YaÅŸÄ±l Ä°ÅŸÄ±q:</b> UÄŸurlu keÃ§id etdikdÉ™ balansÄ±nÄ±za <b>+0.10 â‚¼</b> É™lavÉ™ olunur.</p>
            <hr style="border:0.5px solid #333;">
            <h3 style="color:#00ff88;">ğŸ’³ BakiyÉ™ YÃ¼klÉ™mÉ™:</h3>
            <p>BakiyÉ™ bÃ¶lmÉ™sinÉ™ daxil olaraq mÉ™blÉ™ÄŸi yazÄ±b "YÃ¼klÉ™" dÃ¼ymÉ™sinÉ™ basÄ±n.</p>
            <ul>
                <li>Minimum yÃ¼klÉ™mÉ™: <b>5.00 AZN</b></li>
                <li>Minimum mÉ™rc/cÉ™rimÉ™: <b>0.20 AZN</b></li>
            </ul>
        </div>
    </div>

    <div id="depositModal" class="modal">
        <div class="modal-content" style="text-align:center;">
            <span class="close-x" onclick="closeModal('depositModal')">&times;</span>
            <h2 style="color:#00ff88;">ğŸ’° BakiyÉ™ ArtÄ±r</h2>
            <p style="font-size:13px; color:#ccc;">Minimum artÄ±m: 5.00 â‚¼</p>
            <input type="number" id="depAmount" class="deposit-input" placeholder="0.00" min="5">
            <button class="auth-btn" onclick="processDeposit()">YÃœKLÆMÆNÄ° TAMAMLA</button>
        </div>
    </div>

    <div id="garageModal" class="modal">
        <div class="modal-content">
            <span class="close-x" onclick="closeModal('garageModal')">&times;</span>
            <h2 style="color:#00ff88;">ğŸ›’ Professional Qaraj</h2>
            <div id="garageList">
                <div class="garage-item">
                    <div class="car-preview" style="background:#e74c3c;"><div style="background:#111; width:80%; height:20%; margin:10% auto;"></div></div>
                    <div><b>Sport Red</b><br><small>QiymÉ™t: 15.00 â‚¼</small></div>
                    <button class="car-buy-btn" onclick="buyCar('#e74c3c', 15)">AL</button>
                </div>
                <div class="garage-item">
                    <div class="car-preview" style="background:#f1c40f;"><div style="background:#111; width:80%; height:20%; margin:10% auto;"></div></div>
                    <div><b>Yellow VIP</b><br><small>QiymÉ™t: 30.00 â‚¼</small></div>
                    <button class="car-buy-btn" onclick="buyCar('#f1c40f', 30)">AL</button>
                </div>
            </div>
        </div>
    </div>

    <div class="chat-widget">
        <div id="chat-box">
            <div style="background:#00ff88; color:#000; padding:12px; font-weight:bold; border-radius:15px 15px 0 0;">DÉ™stÉ™k (AI)</div>
            <div id="chat-content" style="flex:1; padding:10px; overflow-y:auto; font-size:13px; color:#eee;"></div>
            <div style="display:flex; padding:10px; border-top:1px solid #333;">
                <input type="text" id="chatInput" style="flex:1; background:none; border:none; color:white; outline:none;" placeholder="YazÄ±n...">
                <button onclick="sendChat()" style="background:none; border:none; color:#00ff88; font-weight:bold; cursor:pointer;">GÃ¶ndÉ™r</button>
            </div>
        </div>
        <button class="chat-btn" onclick="toggleChat()">ğŸ’¬</button>
    </div>

    <script>
        let currentUser = "";
        let balance = 100.00;
        let carColor = "#3498db";
        let isBraking = false;

        // AUTH
        function handleAuth() {
            const user = document.getElementById("username").value.trim();
            const pass = document.getElementById("password").value;
            if (user.length < 3) return alert("Ä°stifadÉ™Ã§i adÄ± Ã§ox qÄ±sadÄ±r!");
            
            if (!localStorage.getItem("pw_" + user)) {
                localStorage.setItem("pw_" + user, pass);
                localStorage.setItem("bal_" + user, 100.00);
            } else if (localStorage.getItem("pw_" + user) !== pass) {
                return alert("SÉ™hv ÅŸifrÉ™!");
            }

            currentUser = user;
            balance = parseFloat(localStorage.getItem("bal_" + user));
            document.getElementById("auth-screen").style.display = "none";
            document.getElementById("game-interface").style.display = "flex";
            updateBalanceUI();
            initGame();
        }

        function updateBalanceUI() {
            document.getElementById("balance").innerText = balance.toFixed(2);
            localStorage.setItem("bal_" + currentUser, balance);
        }

        // DEPOSÄ°T
        function processDeposit() {
            const amount = parseFloat(document.getElementById("depAmount").value);
            if (isNaN(amount) || amount < 5) return alert("Minimum yÃ¼klÉ™mÉ™ mÉ™blÉ™ÄŸi 5.00 AZN-dir!");
            balance += amount;
            updateBalanceUI();
            alert(amount + " AZN uÄŸurla yÃ¼klÉ™ndi!");
            closeModal('depositModal');
        }

        // GAME LOGIC
        function initGame() {
            const canvas = document.getElementById("gameCanvas");
            const ctx = canvas.getContext("2d");
            const brakeBtn = document.getElementById("brakeBtn");
            let carY = 360;
            let linesOffset = 0;
            let trafficLight = { state: "green", timer: 0 };

            brakeBtn.onmousedown = () => isBraking = true;
            brakeBtn.onmouseup = () => isBraking = false;
            brakeBtn.ontouchstart = (e) => { e.preventDefault(); isBraking = true; };
            brakeBtn.ontouchend = () => isBraking = false;

            function gameLoop() {
                trafficLight.timer++;
                if(trafficLight.timer > 160) trafficLight.state = "red";
                if(trafficLight.timer > 340) { trafficLight.state = "green"; trafficLight.timer = 0; }

                if(!isBraking) {
                    linesOffset += 5; if(linesOffset > 100) linesOffset = 0;
                    carY -= 3.5;
                }

                if(carY < -100) {
                    if(trafficLight.state === "red") {
                        balance -= 0.20; 
                        showMsg("-0.20 â‚¼ CÆRÄ°MÆ!", "#ff4d4d");
                    } else {
                        balance += 0.10; 
                        showMsg("+0.10 â‚¼ QAZANC!", "#00ff88");
                    }
                    updateBalanceUI();
                    carY = 360;
                }

                // DRAW
                ctx.fillStyle = "#2ecc71"; ctx.fillRect(0,0,500,500); // Grass
                ctx.fillStyle = "#34495e"; ctx.fillRect(75,0,300,500); // Road
                ctx.fillStyle = "white"; 
                for(let i=0; i<10; i++) ctx.fillRect(222, i*100 + linesOffset-100, 6, 40); // Lines
                ctx.fillStyle = "white"; ctx.fillRect(75, 120, 300, 10); // Stop line

                // Light
                ctx.fillStyle = "#111"; ctx.fillRect(390, 40, 40, 100);
                ctx.fillStyle = trafficLight.state === "red" ? "#ff0000" : "#300"; ctx.beginPath(); ctx.arc(410, 65, 12, 0, 7); ctx.fill();
                ctx.fillStyle = trafficLight.state === "green" ? "#00ff88" : "#030"; ctx.beginPath(); ctx.arc(410, 115, 12, 0, 7); ctx.fill();

                // Car
                ctx.fillStyle = carColor; ctx.fillRect(200, carY, 50, 95); // Body
                ctx.fillStyle = "#111"; ctx.fillRect(205, carY+20, 40, 25); // Window
                ctx.fillStyle = "yellow"; ctx.fillRect(205, carY+2, 10, 6); ctx.fillRect(235, carY+2, 10, 6); // Lights

                requestAnimationFrame(gameLoop);
            }
            gameLoop();
        }

        // MODALS
        function openModal(id) { document.getElementById(id).style.display = "flex"; }
        function closeModal(id) { document.getElementById(id).style.display = "none"; }
        function showMsg(t, c) {
            const m = document.getElementById("game-msg");
            m.innerText = t; m.style.color = c; m.style.opacity = 1;
            setTimeout(() => m.style.opacity = 0, 1500);
        }
        function buyCar(color, price) {
            if (balance >= price) {
                balance -= price; updateBalanceUI();
                carColor = color; alert("TÉ™brik edirik! Yeni maÅŸÄ±n aktiv edildi.");
                closeModal('garageModal');
            } else alert("BalansÄ±nÄ±z kifayÉ™t deyil!");
        }

        // CHAT
        function toggleChat() {
            const c = document.getElementById("chat-box");
            c.style.display = c.style.display === "flex" ? "none" : "flex";
        }
        function sendChat() {
            const i = document.getElementById("chatInput"); if(!i.value) return;
            const content = document.getElementById("chat-content");
            content.innerHTML += `<p><b>Siz:</b> ${i.value}</p>`;
            setTimeout(() => {
                content.innerHTML += `<p style="color:#00ff88"><b>DÉ™stÉ™k:</b> Salam! BakiyÉ™ yÃ¼klÉ™mÉ™k Ã¼Ã§Ã¼n yuxarÄ±dakÄ± 'BakiyÉ™' dÃ¼ymÉ™sindÉ™n istifadÉ™ edin. Minimum 5 AZN yÃ¼klÉ™yÉ™ bilÉ™rsiniz.</p>`;
                content.scrollTop = content.scrollHeight;
            }, 600);
            i.value = "";
        }
    </script>
</body>
</html>
